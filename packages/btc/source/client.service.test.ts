import { Collections, IoC, Services } from "@ardenthq/sdk";
import { BigNumber } from "@ardenthq/sdk-helpers";
import { DateTime } from "@ardenthq/sdk-intl";
import { describe } from "@ardenthq/sdk-test";

import { createService } from "../test/mocking";
import { ClientService } from "./client.service.js";
import { ConfirmedTransactionData } from "./confirmed-transaction.dto.js";
import { SignedTransactionData } from "./signed-transaction.dto.js";
import { WalletData } from "./wallet.dto.js";

describe("ClientService", async ({ beforeAll, afterEach, it, assert, loader, nock }) => {
	beforeAll(async (context) => {
		context.subject = await createService(ClientService, "btc.testnet", (container) => {
			container.constant(IoC.BindingType.Container, container);
			container.constant(IoC.BindingType.DataTransferObjects, {
				ConfirmedTransactionData,
				SignedTransactionData,
				WalletData,
			});
			container.singleton(IoC.BindingType.DataTransferObjectService, Services.AbstractDataTransferObjectService);
		});
	});

	afterEach(() => nock.cleanAll());

	it("#transaction should succeed", async (context) => {
		nock.fake("https://btc-test.arkvault.io")
			.get("/api/transactions/68ad0264053ab94fa7749e78d2f728911d166ca9af8dbb68e6ee264958ca7f32")
			.reply(200, loader.json(`test/fixtures/client/transaction.json`));

		const result = await context.subject.transaction(
			"68ad0264053ab94fa7749e78d2f728911d166ca9af8dbb68e6ee264958ca7f32",
		);

		assert.instance(result, ConfirmedTransactionData);
		assert.is(result.id(), "21c0cdf1d1e191823540841dd926944e7bc4ee37a7227ec9609ad9715227a02d");
		assert.is(result.type(), "transfer");
		assert.instance(result.timestamp(), DateTime);
		assert.equal(result.confirmations(), BigNumber.make(123_456));
		assert.equal(result.amount(), BigNumber.make(62_550_000));
		assert.equal(result.fee(), BigNumber.make(50_000));
		assert.undefined(result.memo());
	});

	it("#transactions should succeed", async (context) => {
		nock.fake("https://btc-test.arkvault.io")
			.post("/api/wallets/transactions", { addresses: ["12C1rVsgUUNKfFYWQ9X18M38c4hsGV9T5w"] })
			.reply(200, loader.json(`test/fixtures/client/transactions.json`));

		const result = await context.subject.transactions({
			identifiers: [{ type: "address", value: "12C1rVsgUUNKfFYWQ9X18M38c4hsGV9T5w" }],
		});
		assert.instance(result, Collections.ConfirmedTransactionDataCollection);
		assert.is(result.currentPage(), 1);
		assert.is(result.getPagination().last, 1);
		assert.is(result.getPagination().self, 1);
		assert.undefined(result.getPagination().prev);
		assert.undefined(result.getPagination().next);

		const transaction = result.items()[0];
		assert.instance(transaction, ConfirmedTransactionData);
		assert.is(transaction.id(), "21c0cdf1d1e191823540841dd926944e7bc4ee37a7227ec9609ad9715227a02d");
		assert.is(transaction.type(), "transfer");
		assert.instance(transaction.timestamp(), DateTime);
		assert.equal(transaction.confirmations(), BigNumber.make(559_952));
		assert.equal(transaction.amount(), BigNumber.make(62_550_000));
		assert.equal(transaction.fee(), BigNumber.make(50_000));
		assert.undefined(transaction.memo());
	});

	it("should derive bip44 addresses from xpub", async (context) => {
		nock.fake("https://btc-test.arkvault.io:443", { encodedQueryParams: true })
			.post(
				"/api/wallets/addresses",
				'{"addresses":["mvVAfs3MCDYg7HokDhL6pPuef6KZLPdUUz","msy7ZqCfVFBuNAf4GJSEnrpc9HMpn6mPV2","n4pMT65JrzLCfA6ErNX63yb6GvcA2oMwtA","mjJ7AvduauMXmtj8AcxfkdJkjhYcKqChJR","mm9gzxT8zh7Beo1wxmNKSgePXVSEYSrCrM","mjTHjhtECpHPpTckxqUuEirexUoXnVa2C4","mhn5Lm29KHQpSFb888Ne2N8sjCoTstAAAq","mrHYgvzE2xAL7sxVfJDP4WuGUP181RvBr3","mnL5PvKG4GXwX3AYLSx75S98vFeFteBJRq","mn6RriDhuTh9DrXX8WwKmHBpMFkXpU4w4A","msR3m6CyXZ9bTG5ooQDcbwEtzwgAsKrKDw","n3kvzGysEJ3XuzecWaAtBTxjnpD4BZAiYe","n2bKDbjXLj3QYLMfBmd9GVcy1c19wJUxWi","mxyZfgBZo7goEiMFz4ZfXpWjqxGdfJnckQ","mhThc9DvGgJZZoDf3JxE8mHpcTS8wBoiDH","mzTxEzujzS2bMD9BWYck2U7k9m79grRnaw","mpfthavUUarbK8vBkrLEqBX3SDaj8632Af","moyKoZsCf6UP8X4HkRxdKmq5ihamCNpxon","mksdPb37aU3QwvdHS3Q442PiPX1qxhquq3","n4gPfaKpeLpTUyazt296bHf3hj6ZB7H2wc","mzXqh3GSAkRF83HA9xXvgkCsUMPhtbpF47","mvRPTy61Eu5FuQkKSD9RschXsCcgT7F9Ke","mfnKdSFaXGTgjd67xZrPMrxamBxuk9JfwF","miqgjnVTsheUs75EQ7W6MVN2ScvP7uB8MX","mtqgfbjZ9tstZtr3jyVKNzjPsfvKgqwdsh","mj6WUpsrEE1DKyyh6Tt4dL4Q6ovYMJXDqv","n2GwVELhoFabFoideHVSfimb66wUGHPzmp","mi55ngoeJQUmZ8ewxe799pQ744JkMbCjcr","mtd1drZCsnBXSnNhHj74N42xrXdTNQefbG","moAgQVoviA2D2aQV2jB9CRyjQF4KcWJg1t","mtoy82b6JjSjU44YMm49bUW3kkrgcA7eEL","mvXQdC1Jup75WNTry5zx7iaYb6UFWtgt4o","moa9QDEacjkayZ5VbWTTfCNkjKAVxgiX7K","moyESkaN1TDxtdcMFk5LTU8EcB7tP2eSgJ","mpRcrvTbFmwymYgW79m8tE5ANWJEGhBq2s","mwcQ2Kd7fKqH9x7cWgMksmKy6UL8BYZFbc","mnR7bePTUyRvm4Vu4EkvYrbc7UbLF7aiwi","mqvktLDsBXL7WVLamv9XAaNw3mProXaah3","mhCKygbPwuUojtMXKn5ugoDzfTyMxFek6D","mhPGchVv6RRVAGBwGNNBzNpumQk2YGm9Gp","my1Qedk3CfmGta8LWKQ7AbjTZCiA55Yt2S","mwB5CuoASxBWoqXBrq7mLYFNdvSrYhRvgm","mperSDrmbXYiu6iwsKKuspm8aPMEphvPWT","mhxa7TrYpBtLUPYmNmy7JsUZk5V2REXVww","mn1yfnj9LoEy9CLHmzw56uSmeyadB4Hzr5","mg7ZjKofdu1PEHjvC4WUrDsoC3nryoNUMH","mqM9sEh2K6bLwzcu5p6Gxxc6qVzFekrTBz","mwrERKNjnPr8tpu3grMy8zgEH68f9sxJx8","mxbLagg9QeW3k1eU9WEPso47f9nSwLhfPu","myWQKwR4iH3vsrdqKpznCPb12EshFSHeQ6","mfo4DWwc97XDr3yu8C8UxBA9djH4CHD7kG","mj7nVSAaV48zHRiiNtE4UCUe2x78tC2Qjp","my5PR9y5a5V23ufKjJ3v8wJpf8DaB7uwiL","mzGiFCYG6bsuuuV22wWt1u7A8UvCNZ8e4Q","myt62zMyGwmHNiV1h9ML6TuzU8nCYvcGpy","mxxFkSeZm6D5E6wjopqa97vszv6rqs9UCD","n4Mw2mYzqNFL8C6M3RNVBxfBRwAN9hcjG6","msJRXNbQkHynga9eW6pFLqAs1eZhzFoWQZ","n2DBGhEALVhmkyL6LzMxdgRh4SF1Ke2Mw9","mpM3wMnFjRUTcDWLcd5DZ51TgeqFw5N2ZM","mfx8pr2V2momqz9St5bbCaHeQCwH41TXne","mswRM5kueZHKkWPweq4nyfFpJRiEQ6UTrj","mhuxUusT441up1qCuKH6dCbdvXNECY14nM","mh5RPyq3Czki5WgWajEvTfE92PWgCiCont","mwxwmMPD27HhiatihhSspcCj4N2LaBrzcj","mmLAdsaK8RUhP7yqhSJM9caW6hrRKisLac","mmT7jzFyYPU6UnVSJ1bjxfJVYN1AKhZWJa","mwKdHeoHC5CPmm9CPRwoiUhwPWMMrosU3e","n3ATQKG5hVCXybev6fjZdZotbT5ih6LFDP","mvYaUg6WrAJWrjVVZBd7nPoe8zXay1tV9i","mhyfefXY1E46vHcdtDiUvY6HfS7LMXtKAJ","mswLRozh5Dpm7M7srHsF6KM3zDFZTJEEVn","mprDv1gvszNaVn47TaWPGgCARWyeq5yD6J","mi9YQP1ju8UjVa3uGA8BHTC3odh3gBJ1QR","mtuVbP91A4c8de2swYdDGyjJFmXjmCHQdz","mvQnYSDVvP6km5cU5TN3aApPKGa5PmFcSw","mk3JiS44hpN4dnnoS45xpuNXoALcEQE4iY","mnSY6sVsCBnHe6PVVVFK6bV6tf3Ri1ykcG","mtsVQhKHxohGeNDPK1epp2DPKT2jmZRn6b","mh7Ur94RHTwgjGteiybQN7nhmWZRKWo9ou","mzLsZTGwRhALkrSC555Fgetym5XLhfpW8e","mfdPbWAXs2sMBWkwGW9KgwGEEjy7R4oWhf","mvJCVH63DnXrzRycMJs15i3MEFQ3ginVvP","mz1ts8kGKWNuyxLBk7vEzsL8og2EPp1Vce","mn31JAtD9YrFPFMJAgQCrd3vi8XZNEA43e","n4bAGQkxXirKau9KNCex7HDY49YnDgsp3g","msbszKYDW4qCB8ueShWEYBuHsfeEBc8fdq","n1Q2zUqpWkkhS28eAtX3deF8xNLUWN3bzP","msmrDofDLBV3pWhbVXhcJo3Qm8VxYuKBL6","mk8gb2D8JNiQijb41NjWSRKBLv7zSVs4j3","mu5BVNMJ5HNrh2FP4t98Qmhfx5T1Gr3isH","mkd7kigFhRAgLXhcDQ12194NDiVKqJrdzF","n2AJmJCtyDiZd66CN9S6RmzTVK9TsCUTzv","mtNoXBnrwBLfwqbJe1syBZwAAsk9E1LpSh","mmnjKUc85eX49Aqnbibo113yba9DqyUUxH","my31AvFqnaRXs2CQdz1t9TXNU1ahZr7kph","mwWNQuwD6u4SmpTxJb8HVoYNDrMap6PYCh","mo5aR4S9JYb3PQpot8wBwhQyEtNp6wsdZb","mjjNUNVcG7qpHQiWhU96MhQVip5Jvw1fME","n3Shrgfben2UAvgqhGo4L9eEpw2ZcQ8Gxf"]}',
			)
			.reply(
				200,
				'{"data":{"mvVAfs3MCDYg7HokDhL6pPuef6KZLPdUUz":true,"msy7ZqCfVFBuNAf4GJSEnrpc9HMpn6mPV2":false,"n4pMT65JrzLCfA6ErNX63yb6GvcA2oMwtA":false,"mjJ7AvduauMXmtj8AcxfkdJkjhYcKqChJR":false,"mm9gzxT8zh7Beo1wxmNKSgePXVSEYSrCrM":false,"mjTHjhtECpHPpTckxqUuEirexUoXnVa2C4":false,"mhn5Lm29KHQpSFb888Ne2N8sjCoTstAAAq":false,"mrHYgvzE2xAL7sxVfJDP4WuGUP181RvBr3":false,"mnL5PvKG4GXwX3AYLSx75S98vFeFteBJRq":false,"mn6RriDhuTh9DrXX8WwKmHBpMFkXpU4w4A":false,"msR3m6CyXZ9bTG5ooQDcbwEtzwgAsKrKDw":false,"n3kvzGysEJ3XuzecWaAtBTxjnpD4BZAiYe":false,"n2bKDbjXLj3QYLMfBmd9GVcy1c19wJUxWi":false,"mxyZfgBZo7goEiMFz4ZfXpWjqxGdfJnckQ":false,"mhThc9DvGgJZZoDf3JxE8mHpcTS8wBoiDH":false,"mzTxEzujzS2bMD9BWYck2U7k9m79grRnaw":false,"mpfthavUUarbK8vBkrLEqBX3SDaj8632Af":false,"moyKoZsCf6UP8X4HkRxdKmq5ihamCNpxon":false,"mksdPb37aU3QwvdHS3Q442PiPX1qxhquq3":false,"n4gPfaKpeLpTUyazt296bHf3hj6ZB7H2wc":false,"mzXqh3GSAkRF83HA9xXvgkCsUMPhtbpF47":false,"mvRPTy61Eu5FuQkKSD9RschXsCcgT7F9Ke":false,"mfnKdSFaXGTgjd67xZrPMrxamBxuk9JfwF":false,"miqgjnVTsheUs75EQ7W6MVN2ScvP7uB8MX":false,"mtqgfbjZ9tstZtr3jyVKNzjPsfvKgqwdsh":false,"mj6WUpsrEE1DKyyh6Tt4dL4Q6ovYMJXDqv":false,"n2GwVELhoFabFoideHVSfimb66wUGHPzmp":false,"mi55ngoeJQUmZ8ewxe799pQ744JkMbCjcr":false,"mtd1drZCsnBXSnNhHj74N42xrXdTNQefbG":false,"moAgQVoviA2D2aQV2jB9CRyjQF4KcWJg1t":false,"mtoy82b6JjSjU44YMm49bUW3kkrgcA7eEL":false,"mvXQdC1Jup75WNTry5zx7iaYb6UFWtgt4o":false,"moa9QDEacjkayZ5VbWTTfCNkjKAVxgiX7K":false,"moyESkaN1TDxtdcMFk5LTU8EcB7tP2eSgJ":false,"mpRcrvTbFmwymYgW79m8tE5ANWJEGhBq2s":false,"mwcQ2Kd7fKqH9x7cWgMksmKy6UL8BYZFbc":false,"mnR7bePTUyRvm4Vu4EkvYrbc7UbLF7aiwi":false,"mqvktLDsBXL7WVLamv9XAaNw3mProXaah3":false,"mhCKygbPwuUojtMXKn5ugoDzfTyMxFek6D":false,"mhPGchVv6RRVAGBwGNNBzNpumQk2YGm9Gp":false,"my1Qedk3CfmGta8LWKQ7AbjTZCiA55Yt2S":false,"mwB5CuoASxBWoqXBrq7mLYFNdvSrYhRvgm":false,"mperSDrmbXYiu6iwsKKuspm8aPMEphvPWT":false,"mhxa7TrYpBtLUPYmNmy7JsUZk5V2REXVww":false,"mn1yfnj9LoEy9CLHmzw56uSmeyadB4Hzr5":false,"mg7ZjKofdu1PEHjvC4WUrDsoC3nryoNUMH":false,"mqM9sEh2K6bLwzcu5p6Gxxc6qVzFekrTBz":false,"mwrERKNjnPr8tpu3grMy8zgEH68f9sxJx8":false,"mxbLagg9QeW3k1eU9WEPso47f9nSwLhfPu":false,"myWQKwR4iH3vsrdqKpznCPb12EshFSHeQ6":false,"mfo4DWwc97XDr3yu8C8UxBA9djH4CHD7kG":false,"mj7nVSAaV48zHRiiNtE4UCUe2x78tC2Qjp":false,"my5PR9y5a5V23ufKjJ3v8wJpf8DaB7uwiL":false,"mzGiFCYG6bsuuuV22wWt1u7A8UvCNZ8e4Q":false,"myt62zMyGwmHNiV1h9ML6TuzU8nCYvcGpy":false,"mxxFkSeZm6D5E6wjopqa97vszv6rqs9UCD":false,"n4Mw2mYzqNFL8C6M3RNVBxfBRwAN9hcjG6":false,"msJRXNbQkHynga9eW6pFLqAs1eZhzFoWQZ":false,"n2DBGhEALVhmkyL6LzMxdgRh4SF1Ke2Mw9":false,"mpM3wMnFjRUTcDWLcd5DZ51TgeqFw5N2ZM":false,"mfx8pr2V2momqz9St5bbCaHeQCwH41TXne":false,"mswRM5kueZHKkWPweq4nyfFpJRiEQ6UTrj":false,"mhuxUusT441up1qCuKH6dCbdvXNECY14nM":false,"mh5RPyq3Czki5WgWajEvTfE92PWgCiCont":false,"mwxwmMPD27HhiatihhSspcCj4N2LaBrzcj":false,"mmLAdsaK8RUhP7yqhSJM9caW6hrRKisLac":false,"mmT7jzFyYPU6UnVSJ1bjxfJVYN1AKhZWJa":false,"mwKdHeoHC5CPmm9CPRwoiUhwPWMMrosU3e":false,"n3ATQKG5hVCXybev6fjZdZotbT5ih6LFDP":false,"mvYaUg6WrAJWrjVVZBd7nPoe8zXay1tV9i":false,"mhyfefXY1E46vHcdtDiUvY6HfS7LMXtKAJ":false,"mswLRozh5Dpm7M7srHsF6KM3zDFZTJEEVn":false,"mprDv1gvszNaVn47TaWPGgCARWyeq5yD6J":false,"mi9YQP1ju8UjVa3uGA8BHTC3odh3gBJ1QR":false,"mtuVbP91A4c8de2swYdDGyjJFmXjmCHQdz":false,"mvQnYSDVvP6km5cU5TN3aApPKGa5PmFcSw":false,"mk3JiS44hpN4dnnoS45xpuNXoALcEQE4iY":false,"mnSY6sVsCBnHe6PVVVFK6bV6tf3Ri1ykcG":false,"mtsVQhKHxohGeNDPK1epp2DPKT2jmZRn6b":false,"mh7Ur94RHTwgjGteiybQN7nhmWZRKWo9ou":false,"mzLsZTGwRhALkrSC555Fgetym5XLhfpW8e":false,"mfdPbWAXs2sMBWkwGW9KgwGEEjy7R4oWhf":false,"mvJCVH63DnXrzRycMJs15i3MEFQ3ginVvP":false,"mz1ts8kGKWNuyxLBk7vEzsL8og2EPp1Vce":false,"mn31JAtD9YrFPFMJAgQCrd3vi8XZNEA43e":false,"n4bAGQkxXirKau9KNCex7HDY49YnDgsp3g":false,"msbszKYDW4qCB8ueShWEYBuHsfeEBc8fdq":false,"n1Q2zUqpWkkhS28eAtX3deF8xNLUWN3bzP":false,"msmrDofDLBV3pWhbVXhcJo3Qm8VxYuKBL6":false,"mk8gb2D8JNiQijb41NjWSRKBLv7zSVs4j3":false,"mu5BVNMJ5HNrh2FP4t98Qmhfx5T1Gr3isH":false,"mkd7kigFhRAgLXhcDQ12194NDiVKqJrdzF":false,"n2AJmJCtyDiZd66CN9S6RmzTVK9TsCUTzv":false,"mtNoXBnrwBLfwqbJe1syBZwAAsk9E1LpSh":false,"mmnjKUc85eX49Aqnbibo113yba9DqyUUxH":false,"my31AvFqnaRXs2CQdz1t9TXNU1ahZr7kph":false,"mwWNQuwD6u4SmpTxJb8HVoYNDrMap6PYCh":false,"mo5aR4S9JYb3PQpot8wBwhQyEtNp6wsdZb":false,"mjjNUNVcG7qpHQiWhU96MhQVip5Jvw1fME":false,"n3Shrgfben2UAvgqhGo4L9eEpw2ZcQ8Gxf":false}}',
				[],
			);

		nock.fake("https://btc-test.arkvault.io:443", { encodedQueryParams: true })
			.post(
				"/api/wallets/addresses",
				'{"addresses":["n3LhrsyE8g1Ga2XPGuXfRkaPcipevENLre","n1ii1xkSqM5zTyY4h5zpAnPi86csRbA5ar","mkEU1tHycuDj2XPcRMBWZHrBvHJXwkcBNR","my6MACmsGA3MXq73KJwnZwcNYwAYNXGGaM","mvY8me8vYkKUz8Qn3pFhionqYWDZeiC1hC","ms9QjBPWq7atAGtp4HrFRUhcuNU2QHj58z","mtkq8N81uLbazEszNZSij7ago4k6KkfjKk","mjZij3tVEKKFdyGcUTTkAVDR7jGhUfxEf7","mhub5yjwn8aktqw2C1hipdYNW83njAgymv","mjP4YPUBZZW6GaXJJ36W8gfTfxMCfuTvbP","n2khkbRh2pc8srDNeqM8uEy3n9APaL8KgV","mtBkrgNXdCX7gBVAugdtNqSq8L56EVV7Uw","mi5VbkBz7tjfg7AQ2oxxQWj78LDBzhrb3d","mhbNtdzhrxRLAuajTLYCzaec3DE79GLjwh","mhuacfeCHWSVweiu6KwDVrTGhsrnCQfTgz","mtbT1i9DnWaUMiWxUvSR42Ve56KbReKcgg","mowcx8DHsDBuhKSQ9XBpML9nZSSB2SyJDc","n2FJRGVUvWEk4rUzfJWkki5jqSg5bBwc98","n1nSwLjZ54S6k58KBwjdNDuqs1mZSCXx3z","moGqYcYarUUiLntbqEL3BBkq4XPuGBoVqN","muqrmFmmdHbbBsEqJMtL6RQm4RHPUYnFk2","mywJckScMZgPMhFmqfxGh7kDAV5cXqjX3r","mxujfFr43vVyNxLabh2F7CdFR9NAEVmUKa","muQRbM43NH5LSigqDDE1z96ygLadhUqAkS","myboc96HfByRuWpXcgvkCBaB9UUyJ9jXKK","mq5wovr1wwJpbCQHZ5T5CyftGCwze1DQDu","mktyYXvra2sribiZcBaTHxgyWqw2Jox3h9","mtJ5uCjqQ9Wi3tji6LXUyt8JhUetoYRumF","muDxFcQ4zhMKb4Zi6hYsVhkRNNZeG1CXtb","n4JzHYrRWJ4neKUs8aA3fhrdNstuzGdGRi","mpwKChjheNta7f2nfMrZtCsFVvTqnX4wu2","mvfYphsn7xAdrf8xAYDSskD5HYGe6BV8F5","mjf2x3fNeB65egmWgMhN4Uk9kCZRF6zSYF","mhC13KUAAi3M837GNu3CtmwaERKskLofS3","mpY4L4WHtXw7KSiZ6PDhZyTF5AhXK2F17X","mgUL2JxfUxtQ4yfMREqCUJDsv71SL3qav9","mz84bNXV2QHVAo82DFVzaymAWsNBn4oxXJ","mod4Whkw4T8P28ezhzmzLAqGCQTu8GXdg5","n3YrL12NVPcQdaeqxHzuNVqRGVAs8qHGfF","miEwLKjCjCLau1nNVQAsHQGjBuYgSK69dg","n42v5BSFfGZKEKDuU59yrur9eKSzg4F6QL","ms2WTyyd3QfrzouWcpmQ8LdhvwLchNogZc","mk5seBWzKpvkZayKcMmLnvfnJHH8ur4HeA","mip1uqSjVnrdNpgSxttgVdFgYRxwYNKcZP","n45q6F5LxC6VBUxdf6nuvp9ZwLGmBvSkfa","n4ZvH3QJ5b2b1yCqLCwuf2zpgtrUX1sGs2","n3rKjHbcp538Jr8n1V3PAZCbDQQyanuePZ","mr9gtRy2VAS78GejUiKgf4myszNPBHoLpV","muxcpyEWrtgAj96nQ9mUbuzQQb9ixDcFZS","mvSgDudA3dJZqA9VdXNv9rSaDBbii12odf","miUCCMdHSUMuqLakeJFnQNubCZiqtagT9V","myBsAAr9mNe1o13qXTA9RQRxVLbE1Cp96i","mt4BQPwHK9qYVyh6sE5Aq6Xm9YFyYSYTw8","mgYbtjCrroxWMbqXXQBos6dNNXfLMoG5ht","n1GtvUHv9mTU5MLcpDDydU4VwQcnvup3uB","mjaG5QmGTSkSXUCsfsRcG2CgERRFFQEfbb","myeyiLHwvy7GsTtHh6VFrRskMeZdqncSro","mx9RRciYgtqTR17CtmB8sZCuwdUesxU8X9","mxx8rKmbVh5bTmQJcip4XzZd3QSkqW44m9","mrWLJUo6HzfYQPXxMbba1Mh81FJ1jThwBV","mtgZJuqhnmzKq2Pqppyo7Bs5KXUBck9BQa","n4ZfnxeQBifbXP5VeoaDQ31eJ2YEePrAD3","mqsQmYqAttASHDRTSNtKvYt1JT95hr69hD","moHvYxq4UKhQ6rJGs3ggF6HjDC3Kt9RSd5","monmjReChadcQ28CsS2dT7cFt2voQrYDqv","mjorkR7WmVTEBprGY9pTCS7cbsSSHb48tq","msB8hgRB375MBJTL4zR89Bn2r1zYmHzVqo","mrzG17RdB7S2rWhVgaTMnmHzwpyLnrB7eE","mrvZPbrtuVtiu2JVFSPHAUeYPUrZVS3yrU","mpcNCGkruWiTCwJ9hTFHej65eEKHjYcUeQ","mjn917wD8SCTUYZekKajRRp9HP4MQL9SwK","mscG2nzgEuWyNU1f3HiWENydwPxMA5A57c","mmk4XeVpZSwJULzAEnA2hHV1eyE43QTNWb","myeA86s9hjuoNc562RqMrTQMbGKXYjW6jQ","mxovJt8LqTX1Q9t6CWy66sF5uzFJQWfhSE","mtHCRA5DQgr4d9pF3J9fPAL95cNurdRDPw","mummhXKqdB8MdS6c73MbBUb7jgPLqveXPo","mymahUdZ3LE6R926ocPjy71VcbkdFLnmtw","mr3WpZkETAM3ynUwP44sDPxjZ8X9FL5ihg","myi466NcvUwEgGiNzYeQyScNqhsNDU4JdZ","mtMQ8mWhcbrKL78yYdkGcHuU9TfCwGtDk7","mj5LmdsePJ4mbaKVSE37dof1GXeLpgrEc1","mxPtTaKJFdxDHHxqKzVZTf73CKgjcJtzAG","mjk1vbP9jzMfGc85CfTbAjxefFBwnRieo3","myR9FJitM5eDYzQvDnGXPXD7LFoXw91oAZ","n4q8fhk38s2rBfS2ZeAAiC3dfMP7X4p7F1","mpiVHCT9Fe6TCh5ZU862tpK6JhdBWoQkRs","mfsK8DnY6Px6NpxqUiCaAHHyMpaYPv67Gk","mpiQLtGkhRUQmo6kHQseAoqdq9WANgvpSJ","mx4cZn3XPRjejzC119buMKYjuRN85Vb5um","mz9VT4zPiH8vBAgKZn7Gf9VnRQstfEcnrX","miaYjb1WetR2MZK5r3zrFxRS8BA6pvrBkU","mtNHUh4G5EBe5KuWtwRsSZSnHQjiRDtMYE","mhGt72NEBz6GY5F7AqgiN1ZHu1mh3jTnU6","n4YN28XhZ9heUDWZ2tTGHmgqSW8mDVsoSr","n1cSBqiuLWygTK29maXmoPp45viXgzpXr8","mnq5grJzMVXehaMRn61Xwt7u5seqnmXcx8","mhoszJwb7jduLfgg18AKMrMBsLBq9WTpzG","mzi3gBmmhe9u8vzrabG2zyw9RYvidsvhsZ","mvzPPyHreLKmcMkm3rt24CDRiv2RfV2mJ9"]}',
			)
			.reply(
				200,
				'{"data":{"n3LhrsyE8g1Ga2XPGuXfRkaPcipevENLre":false,"n1ii1xkSqM5zTyY4h5zpAnPi86csRbA5ar":false,"mkEU1tHycuDj2XPcRMBWZHrBvHJXwkcBNR":false,"my6MACmsGA3MXq73KJwnZwcNYwAYNXGGaM":false,"mvY8me8vYkKUz8Qn3pFhionqYWDZeiC1hC":false,"ms9QjBPWq7atAGtp4HrFRUhcuNU2QHj58z":false,"mtkq8N81uLbazEszNZSij7ago4k6KkfjKk":false,"mjZij3tVEKKFdyGcUTTkAVDR7jGhUfxEf7":false,"mhub5yjwn8aktqw2C1hipdYNW83njAgymv":false,"mjP4YPUBZZW6GaXJJ36W8gfTfxMCfuTvbP":false,"n2khkbRh2pc8srDNeqM8uEy3n9APaL8KgV":false,"mtBkrgNXdCX7gBVAugdtNqSq8L56EVV7Uw":false,"mi5VbkBz7tjfg7AQ2oxxQWj78LDBzhrb3d":false,"mhbNtdzhrxRLAuajTLYCzaec3DE79GLjwh":false,"mhuacfeCHWSVweiu6KwDVrTGhsrnCQfTgz":false,"mtbT1i9DnWaUMiWxUvSR42Ve56KbReKcgg":false,"mowcx8DHsDBuhKSQ9XBpML9nZSSB2SyJDc":false,"n2FJRGVUvWEk4rUzfJWkki5jqSg5bBwc98":false,"n1nSwLjZ54S6k58KBwjdNDuqs1mZSCXx3z":false,"moGqYcYarUUiLntbqEL3BBkq4XPuGBoVqN":false,"muqrmFmmdHbbBsEqJMtL6RQm4RHPUYnFk2":false,"mywJckScMZgPMhFmqfxGh7kDAV5cXqjX3r":false,"mxujfFr43vVyNxLabh2F7CdFR9NAEVmUKa":false,"muQRbM43NH5LSigqDDE1z96ygLadhUqAkS":false,"myboc96HfByRuWpXcgvkCBaB9UUyJ9jXKK":false,"mq5wovr1wwJpbCQHZ5T5CyftGCwze1DQDu":false,"mktyYXvra2sribiZcBaTHxgyWqw2Jox3h9":false,"mtJ5uCjqQ9Wi3tji6LXUyt8JhUetoYRumF":false,"muDxFcQ4zhMKb4Zi6hYsVhkRNNZeG1CXtb":false,"n4JzHYrRWJ4neKUs8aA3fhrdNstuzGdGRi":false,"mpwKChjheNta7f2nfMrZtCsFVvTqnX4wu2":false,"mvfYphsn7xAdrf8xAYDSskD5HYGe6BV8F5":false,"mjf2x3fNeB65egmWgMhN4Uk9kCZRF6zSYF":false,"mhC13KUAAi3M837GNu3CtmwaERKskLofS3":false,"mpY4L4WHtXw7KSiZ6PDhZyTF5AhXK2F17X":false,"mgUL2JxfUxtQ4yfMREqCUJDsv71SL3qav9":false,"mz84bNXV2QHVAo82DFVzaymAWsNBn4oxXJ":false,"mod4Whkw4T8P28ezhzmzLAqGCQTu8GXdg5":false,"n3YrL12NVPcQdaeqxHzuNVqRGVAs8qHGfF":false,"miEwLKjCjCLau1nNVQAsHQGjBuYgSK69dg":false,"n42v5BSFfGZKEKDuU59yrur9eKSzg4F6QL":false,"ms2WTyyd3QfrzouWcpmQ8LdhvwLchNogZc":false,"mk5seBWzKpvkZayKcMmLnvfnJHH8ur4HeA":false,"mip1uqSjVnrdNpgSxttgVdFgYRxwYNKcZP":false,"n45q6F5LxC6VBUxdf6nuvp9ZwLGmBvSkfa":false,"n4ZvH3QJ5b2b1yCqLCwuf2zpgtrUX1sGs2":false,"n3rKjHbcp538Jr8n1V3PAZCbDQQyanuePZ":false,"mr9gtRy2VAS78GejUiKgf4myszNPBHoLpV":false,"muxcpyEWrtgAj96nQ9mUbuzQQb9ixDcFZS":false,"mvSgDudA3dJZqA9VdXNv9rSaDBbii12odf":false,"miUCCMdHSUMuqLakeJFnQNubCZiqtagT9V":false,"myBsAAr9mNe1o13qXTA9RQRxVLbE1Cp96i":false,"mt4BQPwHK9qYVyh6sE5Aq6Xm9YFyYSYTw8":false,"mgYbtjCrroxWMbqXXQBos6dNNXfLMoG5ht":false,"n1GtvUHv9mTU5MLcpDDydU4VwQcnvup3uB":false,"mjaG5QmGTSkSXUCsfsRcG2CgERRFFQEfbb":false,"myeyiLHwvy7GsTtHh6VFrRskMeZdqncSro":false,"mx9RRciYgtqTR17CtmB8sZCuwdUesxU8X9":false,"mxx8rKmbVh5bTmQJcip4XzZd3QSkqW44m9":false,"mrWLJUo6HzfYQPXxMbba1Mh81FJ1jThwBV":false,"mtgZJuqhnmzKq2Pqppyo7Bs5KXUBck9BQa":false,"n4ZfnxeQBifbXP5VeoaDQ31eJ2YEePrAD3":false,"mqsQmYqAttASHDRTSNtKvYt1JT95hr69hD":false,"moHvYxq4UKhQ6rJGs3ggF6HjDC3Kt9RSd5":false,"monmjReChadcQ28CsS2dT7cFt2voQrYDqv":false,"mjorkR7WmVTEBprGY9pTCS7cbsSSHb48tq":false,"msB8hgRB375MBJTL4zR89Bn2r1zYmHzVqo":false,"mrzG17RdB7S2rWhVgaTMnmHzwpyLnrB7eE":false,"mrvZPbrtuVtiu2JVFSPHAUeYPUrZVS3yrU":false,"mpcNCGkruWiTCwJ9hTFHej65eEKHjYcUeQ":false,"mjn917wD8SCTUYZekKajRRp9HP4MQL9SwK":false,"mscG2nzgEuWyNU1f3HiWENydwPxMA5A57c":false,"mmk4XeVpZSwJULzAEnA2hHV1eyE43QTNWb":false,"myeA86s9hjuoNc562RqMrTQMbGKXYjW6jQ":false,"mxovJt8LqTX1Q9t6CWy66sF5uzFJQWfhSE":false,"mtHCRA5DQgr4d9pF3J9fPAL95cNurdRDPw":false,"mummhXKqdB8MdS6c73MbBUb7jgPLqveXPo":false,"mymahUdZ3LE6R926ocPjy71VcbkdFLnmtw":false,"mr3WpZkETAM3ynUwP44sDPxjZ8X9FL5ihg":false,"myi466NcvUwEgGiNzYeQyScNqhsNDU4JdZ":false,"mtMQ8mWhcbrKL78yYdkGcHuU9TfCwGtDk7":false,"mj5LmdsePJ4mbaKVSE37dof1GXeLpgrEc1":false,"mxPtTaKJFdxDHHxqKzVZTf73CKgjcJtzAG":false,"mjk1vbP9jzMfGc85CfTbAjxefFBwnRieo3":false,"myR9FJitM5eDYzQvDnGXPXD7LFoXw91oAZ":false,"n4q8fhk38s2rBfS2ZeAAiC3dfMP7X4p7F1":false,"mpiVHCT9Fe6TCh5ZU862tpK6JhdBWoQkRs":false,"mfsK8DnY6Px6NpxqUiCaAHHyMpaYPv67Gk":false,"mpiQLtGkhRUQmo6kHQseAoqdq9WANgvpSJ":false,"mx4cZn3XPRjejzC119buMKYjuRN85Vb5um":false,"mz9VT4zPiH8vBAgKZn7Gf9VnRQstfEcnrX":false,"miaYjb1WetR2MZK5r3zrFxRS8BA6pvrBkU":false,"mtNHUh4G5EBe5KuWtwRsSZSnHQjiRDtMYE":false,"mhGt72NEBz6GY5F7AqgiN1ZHu1mh3jTnU6":false,"n4YN28XhZ9heUDWZ2tTGHmgqSW8mDVsoSr":false,"n1cSBqiuLWygTK29maXmoPp45viXgzpXr8":false,"mnq5grJzMVXehaMRn61Xwt7u5seqnmXcx8":false,"mhoszJwb7jduLfgg18AKMrMBsLBq9WTpzG":false,"mzi3gBmmhe9u8vzrabG2zyw9RYvidsvhsZ":false,"mvzPPyHreLKmcMkm3rt24CDRiv2RfV2mJ9":false}}',
				[],
			);

		nock.fake("https://btc-test.arkvault.io:443", { encodedQueryParams: true })
			.post("/api/wallets", { addresses: ["mvVAfs3MCDYg7HokDhL6pPuef6KZLPdUUz"] })
			.reply(
				200,
				'{"data":{"balance":100000,"address":["mvVAfs3MCDYg7HokDhL6pPuef6KZLPdUUz"],"publicKey":"figure this out"}}',
				[],
			);

		const xpub =
			"tpubDCzoRb9kb5qSjv1RcX5g4bJ9h28uuaqeuEhFmHCgtGRuoxB121X1e4DSwq44AD1gv7Lu33ije8b4b7fX8oXp3h28CRycqJkFJRd7GSSV7YK";

		const result = await context.subject.wallet({ method: "bip44", type: "extendedPublicKey", value: xpub });

		assert.instance(result, WalletData);
		assert.equal(result.address(), ["mvVAfs3MCDYg7HokDhL6pPuef6KZLPdUUz"]);
		assert.is(result.publicKey(), "figure this out");
		assert.is(result.balance().available.toNumber(), 100_000);
	});

	it("should derive bip49 addresses from xpub", async (context) => {
		nock.fake("https://btc-test.arkvault.io:443", { encodedQueryParams: true })
			.post(
				"/api/wallets/addresses",
				'{"addresses":["2NFJNgNKsTDN3dCcFnu4TU9wAv5dK8tNYqT","2NEPkmdoupAyXarciUDeJCS91LCohgHHoGT","2N7r2MdRF8crWp9n31FGS4khEzbCxqyhyt8","2Mtn7RtFkegoK1jrTTsnrfND7SeeTEvjEtk","2N53JYnPGnHR8n2h2pn2P7KAZxqhDoWY67A","2MsgNpeb3fyevANfqmPYTFp5jdn9LU28wzt","2N4W4SAnbSqpb7XNC6upJ4XuER29yEf4Rn2","2NGMPrjN9Kcz2Z9jNhPUcCbWkxTy1pWbXRY","2N6VBnE4UQyNsk3gdcQ75gKXToVpY5mkGBr","2NGKfiHfTe58Rxe4LX13Bfc57qyZ8LD1hyP","2N5hbkQ1FV97iqSFuqeRkYGj6xoV2V1qTcK","2N99BxgDjBRVkMt5LwP2yR8nAFcA6mwF6o2","2MyRwooR4AYmT1kUNaVb5nChEwLQk25P3Fx","2NCGhJpGdmQ6jT8i8SH7vCJrYt84WxZ8E1j","2MuTCcJiqSNrVZXkfqgxVVRMGWYUhEraEEk","2N2qfsidLiyTV5e8NmMxBvRaTtezN3QMTmd","2Mse6jBMJdQLTqFCPB6Eiae7644TwjeP1xG","2Mvh2xTYn9saQW2vnXZ92rBcBVamUdtf4kk","2NCDfhtPB8NaYjB4GpLVbeYJoeuLgebg5qF","2MvGd2Mk4urBjpjRZ6ne6wRLT78XWUZo6er","2NDxEJqswyuZa8wRXKLHXKyZkTYkitqKaZk","2N8EpTYevKcS5faxVzEhF5DHgsWcsVjw6zH","2MxKCziNX6xe1SZm2sdgjRbqzmQXKVmuGvX","2MzYey51NYRUwQFgu6kc3a2ihRWVWALfvcC","2NBfsH5a8Br8NWHBR57P6TXfmqwbAZ9qgVk","2N3BpXYEKow8BxDKiJWsHtpqmve8F4hBifk","2NCqPYPqeiu1D44FypGDvzTczBdie83fpEJ","2N5yprMcT61Sjqvt94hqsRpdGawmeGYaWBK","2N2Ac1YVPE9f652BA8DkrPQ24oy1Wgk5Bom","2MwKhQ8QvHURpqct5XJJeYGjEWP86URhpmn","2N6NnST3oY9HE8emUQhVi8KQ1FGrY5QoLhe","2N6EfDgD3Qi8f1kStXM7zrkhFBEWqudYz3X","2N1farW9Ti9Nc3vi4ZqCza4uwRt2jhD9Wck","2NFx5LPgRbd2S3ZHsACeQeGejZA3ge11s1c","2NEjFV59BoMnjwNRrMLsgug4owGrZybLPKo","2Mx6LXWDbUM7L7kJSTtpRbfpjbbLBTGCcwp","2Mt9BWz9bN8gyBFFytWhkApY1ZnRZqi64fs","2N2nk4c2mpuz2pREibVGdzAwZ6Gkf5EFLc4","2NFsJHo8248js5HxsQNyfmDaCHPvJEc5Apr","2N37naVHeKPTViRgvHzyRPDdATHKtjY7YbL","2ND5BJCtL5GqKHKUnQo4BD3UkLp2xFZX8Z3","2Mxq3R5GiWSzJviFncCbns5Pgaw14nM9m3z","2NCc95DE7n5tnJZCaSBnCrjLVWzg9feRi9U","2NBbazgxYaPLnB3uSqryn5CaXdvbVo2QyMz","2N3mg9mti798sbuRhH9Cx9e2ReEEPZYBfjo","2Mx9MvRnWTbg211nUhtFjFeT48Nz97f1JNf","2N1SZpY3kuHfVBPcLY8k1sYLem5YoPhybvT","2ND7HCJq1da1GiK7bB9NiWUfDVQfXkWWJ1j","2NE2pYeqpj8yWQARFvv1HpXBGidAWDeUM9s","2MyPQhRHUtedg8iALryD6LQ2UXgjfmfvTBB","2NDSuDbyTFXEbEHPufNpfEaK5jATAqsj9Ug","2NDanpPo5Cjbprs8pgQumDHGqVb1U6qfhbH","2NBfE8YJDBfRVwtF61RmytFTQSzP1N6v93Z","2N3g9GtUJwNbhueDa8wmRVEG7B317YkgLt6","2NFFAXouDpo8K5yw3dkDPW1KaTjWQnaqR9Y","2N6VcVLQx6VVuoXfGHsVThqZsWLA9hteQ1n","2NCrooSPmzmsSueRaNxZ3cuvTpNHhiaXdXp","2NCP9x2WZ7MEMceY3G6EFwMR2jH3eirFZP8","2N6H92vaTNkLr3EZiYcv25RFBCJLZp6KWm6","2Mxg618odGqKnHGWc1ztEJmVKF6yG7uPfqj","2NFkCfwXurHaGZKxCUCnkwrJVNS7tfTXhsi","2Mv86KqLcJXyeuufi7Ds6QvW2aDG7Z8JJTF","2N6KLmUrZQgVaFxHar64fyqhB93umwXNuhz","2MvJHZh9NzkskcxPWnqnKXRSRpvD1VbcLuj","2NEKbX7RjPWFkqrkTQbEh9JCNKF6cD1SWUw","2N9aJdeN6tgbbeWv3zyVsHPK8e45GBbFU9Z","2NELUVqDuNHCiNxtWRagpk6KrDEBzG646tZ","2NGCwimiXhcSLrRMP8Lu3XJhjrMHFWRH6ub","2MvnPByVkLpDU4VtVhNVne1xaCRLmQF7vad","2N1QqBFEr4ZQyVnZnKarRhWNayFgicaDFXN","2N5rcdBpYLCMoJPC7nBVzQg2jt3AoQZbnKd","2N2sGhtCQ1wBaH85AciZLauHdDqT857tymd","2N56BQoqgxM4zG6ijWVvA4UJixzYFPaA1sV","2MzQ456CVGDFgUVb7vmVBCD7sKCXVuEngqB","2Mtq4KYQfWqHvGKmUQQa2SLKN5WkYc9zD7m","2NEXmLnzz1YTHMFUXyzopz3WyH7WU7uVMwi","2N3LtPgwSmjXQybeKmjEzDui5KvdJUvp6Zo","2NEBZFvFV4dSiDqSKHa3P2VmkioWrmANiGA","2NGHwYapHt9UJ2E22Maf15UWo8NASQgSh1p","2N3L7YjxTUAuzkLTqMd6p8vVXCYNaHFY2RK","2N9vVcfJeaLedWf4TFaKUThfhhHzkCGpfmf","2N7xrygAtz3dzfEZVykVAvscPsPScvaTGnw","2NEYqkpGNKK61yQJdX4on2RCV9yza5ZoHqE","2N2QKWsauJpPqDg53EWMSBENbR3rSJbqkGt","2N4sg7XkKs6rxMBNdEeesPu25WoQdAGuN8T","2N92hGzn3tWYsLYbPWqVtsZbvooeqbctama","2MuuNsczrZFwA95JtKZcvthgBQnGcn8uUbE","2N81Tbtwadqwn1XXJ79k5PUQDgFxtTeAnPR","2N2A1nbhHUEqMYQcReKbXKMacXZysFpyMG4","2MxF4rAnDGn4RLjmZvZuhmEhxbpYKb5esZt","2NGST75PgZZKC1ZheXGvP7JQCaJ7qVFpNbK","2N3xV6p86y8GaP9koYx8NkeVw9UXxjpE7UX","2N8LSZm4FrSUnemndEZU3xsE1PTHY1YM8FF","2NFaLUdDjHdXRJSTL4pY4HgXWahZZBwfJfZ","2MsQL7PrMtDLtTcMbz46W5R51zBJujfDmAJ","2MvCZWBFT6To3fTL2ecMVPhWxdn3y3pj3C3","2N1xhbQPbeALjFNfqRtjXgJdb3UUdYtSZvT","2N5NdubhJ3xdqf4zEypydXLFqExSs6GV4WW","2Mvyh5529wfUmThBLg5gV28iC9vd2wa6NCY","2NCjGjjbmJ49yzrUJZVQtRmDL9WqcRgqqfn"]}',
			)
			.reply(
				200,
				'{"data":{"2NFJNgNKsTDN3dCcFnu4TU9wAv5dK8tNYqT":true,"2NEPkmdoupAyXarciUDeJCS91LCohgHHoGT":false,"2N7r2MdRF8crWp9n31FGS4khEzbCxqyhyt8":false,"2Mtn7RtFkegoK1jrTTsnrfND7SeeTEvjEtk":false,"2N53JYnPGnHR8n2h2pn2P7KAZxqhDoWY67A":false,"2MsgNpeb3fyevANfqmPYTFp5jdn9LU28wzt":false,"2N4W4SAnbSqpb7XNC6upJ4XuER29yEf4Rn2":false,"2NGMPrjN9Kcz2Z9jNhPUcCbWkxTy1pWbXRY":false,"2N6VBnE4UQyNsk3gdcQ75gKXToVpY5mkGBr":false,"2NGKfiHfTe58Rxe4LX13Bfc57qyZ8LD1hyP":false,"2N5hbkQ1FV97iqSFuqeRkYGj6xoV2V1qTcK":false,"2N99BxgDjBRVkMt5LwP2yR8nAFcA6mwF6o2":false,"2MyRwooR4AYmT1kUNaVb5nChEwLQk25P3Fx":false,"2NCGhJpGdmQ6jT8i8SH7vCJrYt84WxZ8E1j":false,"2MuTCcJiqSNrVZXkfqgxVVRMGWYUhEraEEk":false,"2N2qfsidLiyTV5e8NmMxBvRaTtezN3QMTmd":false,"2Mse6jBMJdQLTqFCPB6Eiae7644TwjeP1xG":false,"2Mvh2xTYn9saQW2vnXZ92rBcBVamUdtf4kk":false,"2NCDfhtPB8NaYjB4GpLVbeYJoeuLgebg5qF":false,"2MvGd2Mk4urBjpjRZ6ne6wRLT78XWUZo6er":false,"2NDxEJqswyuZa8wRXKLHXKyZkTYkitqKaZk":false,"2N8EpTYevKcS5faxVzEhF5DHgsWcsVjw6zH":false,"2MxKCziNX6xe1SZm2sdgjRbqzmQXKVmuGvX":false,"2MzYey51NYRUwQFgu6kc3a2ihRWVWALfvcC":false,"2NBfsH5a8Br8NWHBR57P6TXfmqwbAZ9qgVk":false,"2N3BpXYEKow8BxDKiJWsHtpqmve8F4hBifk":false,"2NCqPYPqeiu1D44FypGDvzTczBdie83fpEJ":false,"2N5yprMcT61Sjqvt94hqsRpdGawmeGYaWBK":false,"2N2Ac1YVPE9f652BA8DkrPQ24oy1Wgk5Bom":false,"2MwKhQ8QvHURpqct5XJJeYGjEWP86URhpmn":false,"2N6NnST3oY9HE8emUQhVi8KQ1FGrY5QoLhe":false,"2N6EfDgD3Qi8f1kStXM7zrkhFBEWqudYz3X":false,"2N1farW9Ti9Nc3vi4ZqCza4uwRt2jhD9Wck":false,"2NFx5LPgRbd2S3ZHsACeQeGejZA3ge11s1c":false,"2NEjFV59BoMnjwNRrMLsgug4owGrZybLPKo":false,"2Mx6LXWDbUM7L7kJSTtpRbfpjbbLBTGCcwp":false,"2Mt9BWz9bN8gyBFFytWhkApY1ZnRZqi64fs":false,"2N2nk4c2mpuz2pREibVGdzAwZ6Gkf5EFLc4":false,"2NFsJHo8248js5HxsQNyfmDaCHPvJEc5Apr":false,"2N37naVHeKPTViRgvHzyRPDdATHKtjY7YbL":false,"2ND5BJCtL5GqKHKUnQo4BD3UkLp2xFZX8Z3":false,"2Mxq3R5GiWSzJviFncCbns5Pgaw14nM9m3z":false,"2NCc95DE7n5tnJZCaSBnCrjLVWzg9feRi9U":false,"2NBbazgxYaPLnB3uSqryn5CaXdvbVo2QyMz":false,"2N3mg9mti798sbuRhH9Cx9e2ReEEPZYBfjo":false,"2Mx9MvRnWTbg211nUhtFjFeT48Nz97f1JNf":false,"2N1SZpY3kuHfVBPcLY8k1sYLem5YoPhybvT":false,"2ND7HCJq1da1GiK7bB9NiWUfDVQfXkWWJ1j":false,"2NE2pYeqpj8yWQARFvv1HpXBGidAWDeUM9s":false,"2MyPQhRHUtedg8iALryD6LQ2UXgjfmfvTBB":false,"2NDSuDbyTFXEbEHPufNpfEaK5jATAqsj9Ug":false,"2NDanpPo5Cjbprs8pgQumDHGqVb1U6qfhbH":false,"2NBfE8YJDBfRVwtF61RmytFTQSzP1N6v93Z":false,"2N3g9GtUJwNbhueDa8wmRVEG7B317YkgLt6":false,"2NFFAXouDpo8K5yw3dkDPW1KaTjWQnaqR9Y":false,"2N6VcVLQx6VVuoXfGHsVThqZsWLA9hteQ1n":false,"2NCrooSPmzmsSueRaNxZ3cuvTpNHhiaXdXp":false,"2NCP9x2WZ7MEMceY3G6EFwMR2jH3eirFZP8":false,"2N6H92vaTNkLr3EZiYcv25RFBCJLZp6KWm6":false,"2Mxg618odGqKnHGWc1ztEJmVKF6yG7uPfqj":false,"2NFkCfwXurHaGZKxCUCnkwrJVNS7tfTXhsi":false,"2Mv86KqLcJXyeuufi7Ds6QvW2aDG7Z8JJTF":false,"2N6KLmUrZQgVaFxHar64fyqhB93umwXNuhz":false,"2MvJHZh9NzkskcxPWnqnKXRSRpvD1VbcLuj":false,"2NEKbX7RjPWFkqrkTQbEh9JCNKF6cD1SWUw":false,"2N9aJdeN6tgbbeWv3zyVsHPK8e45GBbFU9Z":false,"2NELUVqDuNHCiNxtWRagpk6KrDEBzG646tZ":false,"2NGCwimiXhcSLrRMP8Lu3XJhjrMHFWRH6ub":false,"2MvnPByVkLpDU4VtVhNVne1xaCRLmQF7vad":false,"2N1QqBFEr4ZQyVnZnKarRhWNayFgicaDFXN":false,"2N5rcdBpYLCMoJPC7nBVzQg2jt3AoQZbnKd":false,"2N2sGhtCQ1wBaH85AciZLauHdDqT857tymd":false,"2N56BQoqgxM4zG6ijWVvA4UJixzYFPaA1sV":false,"2MzQ456CVGDFgUVb7vmVBCD7sKCXVuEngqB":false,"2Mtq4KYQfWqHvGKmUQQa2SLKN5WkYc9zD7m":false,"2NEXmLnzz1YTHMFUXyzopz3WyH7WU7uVMwi":false,"2N3LtPgwSmjXQybeKmjEzDui5KvdJUvp6Zo":false,"2NEBZFvFV4dSiDqSKHa3P2VmkioWrmANiGA":false,"2NGHwYapHt9UJ2E22Maf15UWo8NASQgSh1p":false,"2N3L7YjxTUAuzkLTqMd6p8vVXCYNaHFY2RK":false,"2N9vVcfJeaLedWf4TFaKUThfhhHzkCGpfmf":false,"2N7xrygAtz3dzfEZVykVAvscPsPScvaTGnw":false,"2NEYqkpGNKK61yQJdX4on2RCV9yza5ZoHqE":false,"2N2QKWsauJpPqDg53EWMSBENbR3rSJbqkGt":false,"2N4sg7XkKs6rxMBNdEeesPu25WoQdAGuN8T":false,"2N92hGzn3tWYsLYbPWqVtsZbvooeqbctama":false,"2MuuNsczrZFwA95JtKZcvthgBQnGcn8uUbE":false,"2N81Tbtwadqwn1XXJ79k5PUQDgFxtTeAnPR":false,"2N2A1nbhHUEqMYQcReKbXKMacXZysFpyMG4":false,"2MxF4rAnDGn4RLjmZvZuhmEhxbpYKb5esZt":false,"2NGST75PgZZKC1ZheXGvP7JQCaJ7qVFpNbK":false,"2N3xV6p86y8GaP9koYx8NkeVw9UXxjpE7UX":false,"2N8LSZm4FrSUnemndEZU3xsE1PTHY1YM8FF":false,"2NFaLUdDjHdXRJSTL4pY4HgXWahZZBwfJfZ":false,"2MsQL7PrMtDLtTcMbz46W5R51zBJujfDmAJ":false,"2MvCZWBFT6To3fTL2ecMVPhWxdn3y3pj3C3":false,"2N1xhbQPbeALjFNfqRtjXgJdb3UUdYtSZvT":false,"2N5NdubhJ3xdqf4zEypydXLFqExSs6GV4WW":false,"2Mvyh5529wfUmThBLg5gV28iC9vd2wa6NCY":false,"2NCjGjjbmJ49yzrUJZVQtRmDL9WqcRgqqfn":false}}',
				[],
			);

		nock.fake("https://btc-test.arkvault.io:443", { encodedQueryParams: true })
			.post(
				"/api/wallets/addresses",
				'{"addresses":["2Mx8BgV28sZNRfxej4LYwdQFxuAVFfomE5x","2NByjSULyMEkygcskxGSacykeAiPRYZuNwy","2N6RNFCB6P2h3rUCq8FaWWNKgusSQwryqUF","2Mxsne6658s13XN5Di7kemRgHXwFSnv96xP","2MvbRTn2zrdf4Zffx5uUC9opA6iKYyqgfgB","2N4mByjRtfvGiYh8zWqEopQ7D8rHk2VjjCp","2N6LFB1UmeyubUYDvFWVmy5U8cZv8Nj4KHS","2MyLZR3jxuWnayunLYE9QZ7ntkLFP2TmcY9","2MwH78onDen8J6JmgsghWmK8faAbDAAELfA","2Myum3pvpF3pK8YVgmQpxRgo577nnJqZjMu","2N5KpAiFmTgWNBsoNcSh48eDaN9qPtZEBZq","2NDYkMgjJhx4DsfHvHMThJ4pJ5YMf3L3PCg","2MshVgiAm2KxndAJAy2aUDQz9GSr9RfLgZ9","2NFd2XpoFLMEdaLq8vtr5f4TCqDo75E3ugG","2MyBLMkMJaxg9CbyiWMB7DrAzrBrpGDnDgw","2MtVanoDBYxiMrgFrQWJh3rmQVMHt5EaNDs","2N7AbAmZjmfZ2ZvYiZXWEFqnf3VnrgUEV2m","2N6n5ZTjpLBcVSVmqq2Do8Apqe6oxrWcr4o","2MwHNChStcwTN8viwCzuouGdgDgnd9UG6Fq","2NE7KtYVPg44W9CZdtdZHnnPQpT8Jq4E4cN","2NB7TCpaJSo7NrYyFZfWvoifFvsybUHMpfx","2N3VXUTTDWnNE2qDsPkpfL7HcBdVPrNkYSc","2Mu1BN78b3yfgHNdcux69wgBez9djsuy4Z5","2NF1ExWsui72mSdtym2rkHqp7oic2jXcAWy","2N2YJeYjbJfcPhHqJhhgHiistfyLWEf7KVL","2N3UosruupFvh9ESM3hMYXut7FR4GzrCfKn","2NEn84bztkL7JjjVcqSPZ3bX5ZaaeMg68L6","2My3aB99xuKZt8YQ5c5icbdhCKZnJC1BdK4","2Mx1cA4mKGQBbokWqArY3RGvxTYc5Vs3zzP","2MzpHtPDji3yXwarEsQgnfKdKEDk3MfdarF","2Mt7zuTLbEoaRgbg9R8aHuYrUKsMNLNBpwM","2N1JBNrEi9LwhKGE5zNy4EwfHyd9eefeVQE","2N8Mh5vyWqsYZSA44k8AK6qktxZc6qD9Bkr","2NDhgWPV3EqAAWigTDugVthNyNe7cdHEuXh","2NA9Xb14nAKnme29AqQFJrpYN5Thnvf7azE","2NAigvVnz6jG7yDzBfrMPsjs4kNhVUs4XBb","2MzfbLtKYGjkJgg1x8obGRY797wttixSzGY","2N9pT6VMcDyD1GNatekK9VKNUTYob7TqbAT","2N99qkLoRN7DHtxU6dX4nMciNY9rkA6oc7i","2NENaVKYDvL5Kd1YS3KpZwWUo3QNVR9E5mR","2N6KvgRKRdQzaVGXgEBxxFynwHCB6vnLfDG","2N8dBRxpFE8wjgpuxroeHMC3MURzE4JRQVr","2NBDZyi5DhK89B2e8D19dojqBumyabmsqMH","2MuD1ET94HqSSdWdWXjZhF8DsfNDzR6YYzD","2N3L2uCn6bmwJycQ7eC3zY9QEeDpQm7BVd5","2Msd8aLAGSrZMNmuJgdE1RcgA6s97ysRjxC","2N1e8UYbwVRqvwQ1pKwByWWcLRjXtLPAj6o","2MvLEkNXpymZgsuLkJ5yrBeSw7hAeMpdzyW","2N52T9P5buocvJArMEGyfWdkokaupBZB9ZQ","2MuUwYRniGiXA52mxkUDPwCNdf7tD3SDfsu","2MyD1dUeWzcKBBBMBuc13o2ATqdeAtnM48W","2N84AzFo5Zba7eZr6K23jNDHKLva9wirSW2","2NEYFAW3aWiVPpoVuyWLRZGg9EbQd4Exk8L","2NCnjy4MootxcfC4uyXBzu5z2HjPJpk9TdR","2Msf9ThkUpoLBBMytDg4C7uWwRjh2xsGxhA","2N6Pqx55rWQH5SgzyrE7qjKgSAH4GNpkQuy","2N9P5cNyVUsX9TVzr7uhHCXbytRMXyxBEqv","2N8hX4FtSky9gMxF4BQnPhiYKqVhte54gcd","2N5bbmLwcSHf2x2W2YGB9cS1u4pKEgBi4Vt","2N9o3HY1TCetk5xuqe8cxeA8jDh3irF4Jtd","2N7VgkgKnoDP61rxUUNjnTSFqFLBQXsTsex","2NAYLihQScz3iHJTvDmj9ACmcqfqYUNRAxv","2Mv6wbB6ViaZiXz6wJFMa5p8Qrf29qXn1yN","2NBpzkXAdL9xAXWH3rGPt47dtBdc6KGygzZ","2NBzwDvi6iNe3Gj6tnMFJ66NV6Pynw2Cip6","2NCDwyLRCbL5oHkyRucmbG9boe5sywdNqps","2N6MAAVdPooqWBJhdtdNF8BWv8gcwyug2mE","2N5hjtAL8JU53oSvWZoHJk72mstW732MowY","2My9Hs9BtbkRmNXXkQyLt1sFs7P24NGJ4Vx","2N374dZdJpraF5ooHqJSZ8iaSCkDp11RvZf","2N1VLmHhvcPLAL6Vp4xz3hs8zLZrt4nvJSE","2NFRAdLzVBje3oqy9LpujgCDRpFfscumK1i","2NAfeXVeYmtBKgqa8RujTerJEK2qqiz3tDr","2NEg9JNWaCRDP7uuBqHsV3iQcFgtt1gDFXv","2NEekrhjfE2hZCSTY9HVopQ4qeeg6N87nN4","2N6FVVpnN4cznpzWbeWZKoHkoGP1baoBnNE","2MwfHLCfW9EC2fa1mPM5UzTGS4Z1jGhs2xE","2N7KzmzEQabVAYHfhoAdQcXKFucN9igy6no","2NCptervssFFLQAHoWtMihjkn2Mb9ijzQbp","2N3PniBwM7bwdjgheUtkFcwXMcWhxoN3YiX","2NFhnFiLnuivYgMXnzoGuVMP2mU2fiPSX4t","2MumCG7uf8YamjcZDQNDdUan5eTzysFXsZ1","2N6P8vZSqbW8fUkdqJwqJgAJ5n9UsWwtntC","2Mu3XFeGCctySKXW7amoXYg9GFUNUHnsKcL","2N2bgA9p2s8NHPvzJgHKj4GNuxRvfeEMbVF","2MuLXhq2WWymGURMk8WT3LQEUXsSwnKVFBL","2N4jrKnX52MZrSkgjL8cUnHjjSuRYDAEyDB","2NBSbAn8K3ZCi7mZsnzkYhrfNgmfXshcNXk","2N8oBJjTCPVCvEjnsCdAb4x5qCQFgF7oLb6","2NDFLrvcr74xxVmURLRBxH5WBajxY2HATSU","2MuP9YynsptF9eH9iMeLFJx1X3pjLnLsUhi","2N1ZKszXutoGtYwQRNnWAqRCM15QT9qk7in","2NGMz23MswCkzeRveXGAqQRsdmoUN3XhG65","2MtUD1x4CLNTY3QMaLt3dBcz7pd4dZd3eqQ","2N8fafFdBvNTCLDZvFd6PgsfgPumGnSPeaN","2MyVuY7gBey38HMppvmBXWHeuHuqebMkhsY","2MyjBb6omXSkpLYt3oBD1ignW1zSiCH5cUZ","2NDi4oz4uxnckwBtqL4AZBZWrSCfKmV9q1K","2N5yzU6NNdBaWL6pXNuMdnE5hRhsiNed1X1","2N2dSPhNMw5Jy6Yh148iYVxY1ceFMauCfy7"]}',
			)
			.reply(
				200,
				'{"data":{"2Mx8BgV28sZNRfxej4LYwdQFxuAVFfomE5x":true,"2NByjSULyMEkygcskxGSacykeAiPRYZuNwy":false,"2N6RNFCB6P2h3rUCq8FaWWNKgusSQwryqUF":false,"2Mxsne6658s13XN5Di7kemRgHXwFSnv96xP":false,"2MvbRTn2zrdf4Zffx5uUC9opA6iKYyqgfgB":false,"2N4mByjRtfvGiYh8zWqEopQ7D8rHk2VjjCp":false,"2N6LFB1UmeyubUYDvFWVmy5U8cZv8Nj4KHS":false,"2MyLZR3jxuWnayunLYE9QZ7ntkLFP2TmcY9":false,"2MwH78onDen8J6JmgsghWmK8faAbDAAELfA":false,"2Myum3pvpF3pK8YVgmQpxRgo577nnJqZjMu":false,"2N5KpAiFmTgWNBsoNcSh48eDaN9qPtZEBZq":false,"2NDYkMgjJhx4DsfHvHMThJ4pJ5YMf3L3PCg":false,"2MshVgiAm2KxndAJAy2aUDQz9GSr9RfLgZ9":false,"2NFd2XpoFLMEdaLq8vtr5f4TCqDo75E3ugG":false,"2MyBLMkMJaxg9CbyiWMB7DrAzrBrpGDnDgw":false,"2MtVanoDBYxiMrgFrQWJh3rmQVMHt5EaNDs":false,"2N7AbAmZjmfZ2ZvYiZXWEFqnf3VnrgUEV2m":false,"2N6n5ZTjpLBcVSVmqq2Do8Apqe6oxrWcr4o":false,"2MwHNChStcwTN8viwCzuouGdgDgnd9UG6Fq":false,"2NE7KtYVPg44W9CZdtdZHnnPQpT8Jq4E4cN":false,"2NB7TCpaJSo7NrYyFZfWvoifFvsybUHMpfx":false,"2N3VXUTTDWnNE2qDsPkpfL7HcBdVPrNkYSc":false,"2Mu1BN78b3yfgHNdcux69wgBez9djsuy4Z5":false,"2NF1ExWsui72mSdtym2rkHqp7oic2jXcAWy":false,"2N2YJeYjbJfcPhHqJhhgHiistfyLWEf7KVL":false,"2N3UosruupFvh9ESM3hMYXut7FR4GzrCfKn":false,"2NEn84bztkL7JjjVcqSPZ3bX5ZaaeMg68L6":false,"2My3aB99xuKZt8YQ5c5icbdhCKZnJC1BdK4":false,"2Mx1cA4mKGQBbokWqArY3RGvxTYc5Vs3zzP":false,"2MzpHtPDji3yXwarEsQgnfKdKEDk3MfdarF":false,"2Mt7zuTLbEoaRgbg9R8aHuYrUKsMNLNBpwM":false,"2N1JBNrEi9LwhKGE5zNy4EwfHyd9eefeVQE":false,"2N8Mh5vyWqsYZSA44k8AK6qktxZc6qD9Bkr":false,"2NDhgWPV3EqAAWigTDugVthNyNe7cdHEuXh":false,"2NA9Xb14nAKnme29AqQFJrpYN5Thnvf7azE":false,"2NAigvVnz6jG7yDzBfrMPsjs4kNhVUs4XBb":false,"2MzfbLtKYGjkJgg1x8obGRY797wttixSzGY":false,"2N9pT6VMcDyD1GNatekK9VKNUTYob7TqbAT":false,"2N99qkLoRN7DHtxU6dX4nMciNY9rkA6oc7i":false,"2NENaVKYDvL5Kd1YS3KpZwWUo3QNVR9E5mR":false,"2N6KvgRKRdQzaVGXgEBxxFynwHCB6vnLfDG":false,"2N8dBRxpFE8wjgpuxroeHMC3MURzE4JRQVr":false,"2NBDZyi5DhK89B2e8D19dojqBumyabmsqMH":false,"2MuD1ET94HqSSdWdWXjZhF8DsfNDzR6YYzD":false,"2N3L2uCn6bmwJycQ7eC3zY9QEeDpQm7BVd5":false,"2Msd8aLAGSrZMNmuJgdE1RcgA6s97ysRjxC":false,"2N1e8UYbwVRqvwQ1pKwByWWcLRjXtLPAj6o":false,"2MvLEkNXpymZgsuLkJ5yrBeSw7hAeMpdzyW":false,"2N52T9P5buocvJArMEGyfWdkokaupBZB9ZQ":false,"2MuUwYRniGiXA52mxkUDPwCNdf7tD3SDfsu":false,"2MyD1dUeWzcKBBBMBuc13o2ATqdeAtnM48W":false,"2N84AzFo5Zba7eZr6K23jNDHKLva9wirSW2":false,"2NEYFAW3aWiVPpoVuyWLRZGg9EbQd4Exk8L":false,"2NCnjy4MootxcfC4uyXBzu5z2HjPJpk9TdR":false,"2Msf9ThkUpoLBBMytDg4C7uWwRjh2xsGxhA":false,"2N6Pqx55rWQH5SgzyrE7qjKgSAH4GNpkQuy":false,"2N9P5cNyVUsX9TVzr7uhHCXbytRMXyxBEqv":false,"2N8hX4FtSky9gMxF4BQnPhiYKqVhte54gcd":false,"2N5bbmLwcSHf2x2W2YGB9cS1u4pKEgBi4Vt":false,"2N9o3HY1TCetk5xuqe8cxeA8jDh3irF4Jtd":false,"2N7VgkgKnoDP61rxUUNjnTSFqFLBQXsTsex":false,"2NAYLihQScz3iHJTvDmj9ACmcqfqYUNRAxv":false,"2Mv6wbB6ViaZiXz6wJFMa5p8Qrf29qXn1yN":false,"2NBpzkXAdL9xAXWH3rGPt47dtBdc6KGygzZ":false,"2NBzwDvi6iNe3Gj6tnMFJ66NV6Pynw2Cip6":false,"2NCDwyLRCbL5oHkyRucmbG9boe5sywdNqps":false,"2N6MAAVdPooqWBJhdtdNF8BWv8gcwyug2mE":false,"2N5hjtAL8JU53oSvWZoHJk72mstW732MowY":false,"2My9Hs9BtbkRmNXXkQyLt1sFs7P24NGJ4Vx":false,"2N374dZdJpraF5ooHqJSZ8iaSCkDp11RvZf":false,"2N1VLmHhvcPLAL6Vp4xz3hs8zLZrt4nvJSE":false,"2NFRAdLzVBje3oqy9LpujgCDRpFfscumK1i":false,"2NAfeXVeYmtBKgqa8RujTerJEK2qqiz3tDr":false,"2NEg9JNWaCRDP7uuBqHsV3iQcFgtt1gDFXv":false,"2NEekrhjfE2hZCSTY9HVopQ4qeeg6N87nN4":false,"2N6FVVpnN4cznpzWbeWZKoHkoGP1baoBnNE":false,"2MwfHLCfW9EC2fa1mPM5UzTGS4Z1jGhs2xE":false,"2N7KzmzEQabVAYHfhoAdQcXKFucN9igy6no":false,"2NCptervssFFLQAHoWtMihjkn2Mb9ijzQbp":false,"2N3PniBwM7bwdjgheUtkFcwXMcWhxoN3YiX":false,"2NFhnFiLnuivYgMXnzoGuVMP2mU2fiPSX4t":false,"2MumCG7uf8YamjcZDQNDdUan5eTzysFXsZ1":false,"2N6P8vZSqbW8fUkdqJwqJgAJ5n9UsWwtntC":false,"2Mu3XFeGCctySKXW7amoXYg9GFUNUHnsKcL":false,"2N2bgA9p2s8NHPvzJgHKj4GNuxRvfeEMbVF":false,"2MuLXhq2WWymGURMk8WT3LQEUXsSwnKVFBL":false,"2N4jrKnX52MZrSkgjL8cUnHjjSuRYDAEyDB":false,"2NBSbAn8K3ZCi7mZsnzkYhrfNgmfXshcNXk":false,"2N8oBJjTCPVCvEjnsCdAb4x5qCQFgF7oLb6":false,"2NDFLrvcr74xxVmURLRBxH5WBajxY2HATSU":false,"2MuP9YynsptF9eH9iMeLFJx1X3pjLnLsUhi":false,"2N1ZKszXutoGtYwQRNnWAqRCM15QT9qk7in":false,"2NGMz23MswCkzeRveXGAqQRsdmoUN3XhG65":false,"2MtUD1x4CLNTY3QMaLt3dBcz7pd4dZd3eqQ":false,"2N8fafFdBvNTCLDZvFd6PgsfgPumGnSPeaN":false,"2MyVuY7gBey38HMppvmBXWHeuHuqebMkhsY":false,"2MyjBb6omXSkpLYt3oBD1ignW1zSiCH5cUZ":false,"2NDi4oz4uxnckwBtqL4AZBZWrSCfKmV9q1K":false,"2N5yzU6NNdBaWL6pXNuMdnE5hRhsiNed1X1":false,"2N2dSPhNMw5Jy6Yh148iYVxY1ceFMauCfy7":false}}',
				[],
			);

		nock.fake("https://btc-test.arkvault.io:443", { encodedQueryParams: true })
			.post(
				"/api/wallets",
				'{"addresses":["2NFJNgNKsTDN3dCcFnu4TU9wAv5dK8tNYqT","2Mx8BgV28sZNRfxej4LYwdQFxuAVFfomE5x"]}',
			)
			.reply(
				200,
				'{"data":{"balance":59832,"address":["2NFJNgNKsTDN3dCcFnu4TU9wAv5dK8tNYqT","2Mx8BgV28sZNRfxej4LYwdQFxuAVFfomE5x"],"publicKey":"figure this out"}}',
				[],
			);

		const xpub =
			"tpubDCytiPKSLk4fmKfieHrgnTxvQThRzC3HT52t6enTKB915BFYmbr9GKou4Kb3PA77cKdWsL3Zvz4RVJNqmivVM3V6rwzody1L1RSKKbiwXh6";

		const result = await context.subject.wallet({ method: "bip49", type: "extendedPublicKey", value: xpub });

		assert.instance(result, WalletData);
		assert.equal(result.address(), ["2NFJNgNKsTDN3dCcFnu4TU9wAv5dK8tNYqT", "2Mx8BgV28sZNRfxej4LYwdQFxuAVFfomE5x"]);
		assert.is(result.publicKey(), "figure this out");
		assert.is(result.balance().available.toNumber(), 59_832);
	});

	it("should derive bip84 addresses from xpub", async (context) => {
		nock.fake("https://btc-test.arkvault.io:443", { encodedQueryParams: true })
			.post(
				"/api/wallets/addresses",
				'{"addresses":["tb1qwzwugs68sv2f8svsuredhr8ddvnc8tksef5yz3","tb1qtxjg2tzzza7lr60cxadpkp0cuv5zt07h0r2hxs","tb1q0jeyzuj3fwz6nyughmmdsap47xl8zkxcgrta2j","tb1qp4ekevzujt0mcgxvm5lhz2svaujq3qsjrv864d","tb1qdzt03vpcnq4xtcgalgj8je75crmt98ahwd56h6","tb1qgp5hrr4kvplfjg6rnr3her89duz6sgcjr9l6xg","tb1qtcpgl08nh52wtqgndhr7wssa0aw5288nj83w58","tb1q6utl7cpzt6dnm8sp5v8279yxmv2ufu9a4fhuy0","tb1qu2nhuylpw9djpejejzjv8x43qfw7h72qq49hyz","tb1qlnsmeq973nlpkn3dfrgzdtmxm7sxwwnkcmpcz3","tb1qupf7xlutsld6ajpe33z7njlum87qnpx6ug9vj9","tb1qh5gvyp77juyh6tw0y3pfkgpmfh885su7tsn2cr","tb1quf58kja4u48xkgpqdzcsunyafx3w83prvalczq","tb1qr5u0nj2v3p4fxdlnhy6j0xw8ajmlnaxgf5zwy9","tb1qzz96d5w6q3rvjmharjxeft53826y00eyykjk43","tb1q0rnzxz59djmhdh6ej6apk7gg4dvyv205ued4fl","tb1qu2qmfvd559w7z57u0z6kpw2us4mg5fm0my3jdu","tb1qe6zdvnvqgchsxwpg58nkqqdnzv2esn4wx4ekt3","tb1qs84p0jy342cj8ylvxvrtjrpz9l64369uwpcy3p","tb1qvy9mdyfprzauhva9kfsfl7pl8g6j8clp4w85w0","tb1qqjfdux0x5dltzy5hnmgcrnazgq4xcfl7t70xyw","tb1q6rl6ad84g7hww59dwmzsqxhmx5q989fx3378cs","tb1qgpfcm8ug0a9j4lkc77pm29gukl30l9hta2tty2","tb1qdkfqe29cyklwh9mlvsu93qqkj9tx9hrpj9vcpy","tb1qu9swqvrfkmza5jzxze0e83yruenrqfkyz42vch","tb1ql65ylgcypcrdraa4e8tjfwj2dlu5y4kxtjz057","tb1qzykv02g9z9u3vzksjz0ta9xslnsskytpcxjar7","tb1qxmkcgulllpd256ft6zm9pm56tltapw8nhyethm","tb1qrwjvnttd9ddvjspkf77p7maan3snpf09unaugd","tb1q7tarkqsfgteqx79r2t20uwtzl9vva0wx0k4ayz","tb1qlgvxqyl6w35702k2u2939nn9yk59ke453gc8du","tb1q88p4j7zgz9qkmmqn2hnpedtvyydadmf8f0nqce","tb1qveme33aqk50pcgf8ha0x7yk7070zn24adr56vr","tb1q8cvxlzztlx4kjmxw69k0l3mw7gpg7dwyen7t63","tb1q8ecj0zt4wx9nwfvv7zzdd4a5hqft4vweqy5u98","tb1qc4yzwmqf5dj60rkzrjwrl6y3p2hjxvmfz6335g","tb1q03zk0hqnn6efw6jgjxzdh8ecapwe0zq3wn42cl","tb1q5taend7m5cu7t320uwdeeqvxdg2qvj3knh9xqh","tb1qfr6taz70f5nal6p8yu0w0p42tdhl8y5stc0wyh","tb1qk0rfj3fmfaxym8jzzghw7xj0hvey2a6nqtsk25","tb1qgfh9l7mexv9e46tztt9m73reke9u48q6uunmhu","tb1qaa6u30n6t33x3qtkfqgr0csaudv67gn3lf8g6d","tb1q5p2z4m2zcdx4d2lnh07y43qfkzssdz0aqy2wsp","tb1qrj38tggucdz80pwn3qa8862laa8s68cyhc2l7k","tb1q9vuv9rxdcuekrzc7cnwphltdd3jkfrrrcra7er","tb1q3efwr9h42h67wqgqhr8vkhhn8jh75307ndk65z","tb1q5fvq44fnq4u8p6jn83my26ryfy2urqppghavl8","tb1q9tdrprakpaa988mfc8rcz8pz463h0m0nrf522w","tb1qmuc75aqktsuqcx0euzmxx80kfskytt5tnukr52","tb1q7tjr75nnk6jcja50mhclnvrerx24umv5wh0sy0","tb1q0lynmvww482c655eykytt8cayvmmre4je5qwvv","tb1qpvwctppnn7z42zgkcxuqwlvn3h5gqdwrpvxz3q","tb1qexrzqvj2zwedpzvx9wygtvxwt60vf8v3pzshmr","tb1qfyq8zvc5d2qg4kuaj73qgsp8fjr2rsmvlkvpme","tb1qu57cwgs7qsxm8qup7rsxtj66fe5ga535ll2hfp","tb1qee2tzzywvurq25rk40mts9ktepe54a3zftm2yx","tb1qej8tsceu9md3zg0v65hwyeer2gc6jvyk0qtdnp","tb1qk9fufzr5v4n4r5gwdtp0k936m68jttm6hcaxe7","tb1qjqxv88rt5r6hu3x2ss6rwdstz7efyp5hufcpd4","tb1q0rwmmpuyuzyfzglksxuahwqckxarqmhd0pvfp7","tb1qzxkrjd7s600c4f3a2lltm9hkkxut77ewu4unsp","tb1qg80u5d8uczmaumwu33deejppsqjujtax9r9dhc","tb1q8cgvxnmgwhyp3ep2zpx2cxhufl9pk63qdxm26d","tb1q3spthwkc28zdc23yn435vv2z8ewda694u4m9a0","tb1qweawrnsqe5vxdmpjfwyqx9s9r37pwnvypygve5","tb1q6w7866urtvha9t6kq65est66z9ufx2vuueqfpx","tb1q00hfkswhpy70mrssqqqh0x22r7jsmzt33f56ep","tb1q04unutzqzj7ly984pvkffc75f023l5vc4639yu","tb1qgvpuuwjev6e6e8f7qrtsunnsc9ldnt24ewrwfd","tb1qu2gssd6t5krj9lurjy6dnk0tnfwg22pajvw9my","tb1q3s6gvwctm94h5j5jp7su5l4wxupw5qnvs4nwjv","tb1q45mp7jusv8q0ksq0enfagt6z0kx0ef6gdzv5p9","tb1qassvj4kccfwmevt3d6ee8j8zzwr2luynwpsp0a","tb1qmhrc3xrj9z4zuhkvvhx45vulspgg0j4nl3ykm4","tb1qhkrtsvlnntlwqfev5egcd02h54ualu2ss8zmjm","tb1q3ws0px0ehkg6xueucf7dsqwz2cj2fszs2mpym9","tb1qphn2683pdvpz5lgndl5ref486aehp30ghgeqw9","tb1q69ct8fadgrx0gz8kpze3msnefew5k9r3xxa8yk","tb1q70y6wq5twl2hjycehn8cgj3y2xgnq0qcem8elm","tb1q2pugxd8avs5ewk3cfq6d6c25ug9yf7r3278s5x","tb1q3n8a2mhsav2wuxm0myeatuemce8m7d2z3f37ta","tb1qapqysswftgya80ec3svav4n9sjryc3uy07t5wk","tb1qxv33cmhzgzkmpdtyduzxujtz3xy8m8f37g3mps","tb1q7uamgk7mhrwhczfeuxasm0csyq5a8qyyng4ac4","tb1qwlhdldau0778uw30cnfkhs4g5k0rnzdzvph6gt","tb1qprxun35jdxfd9hfcps58atyx5rsl487wkxuw72","tb1q9599m2gx9kmtxty4hg4np0dkn0nx8e4dts735w","tb1qut5a3g6xzse2x8w6rw5uqj8ev5jj0cud8jlrew","tb1qusmz2sygj7yn9jthvjaqm4n2l8kj783wgq6fdy","tb1qntqz4443sya2cm3vevhc2hgxljtykt7f5kkl6x","tb1qthptzxnvw7hvv9ph8vr5lgexwsdgq2zl7yr0pw","tb1q9e9yz469vpyyexjf9lpyf5cnxsnvegptyk40rw","tb1q2q0zgn9yf9pgfhxzu9hg9a3hcu6u77d9p8f2n0","tb1q0yer2sty4rsjcat2qn722pt806h89fpa7q3r9x","tb1q7q6ry5cm57e2qk549zpylpznlzuc03zya3luzv","tb1q2uv9y43l4jyszf7y4mmgrpqn38ll6rkcapyvz9","tb1qzya00lztregd6sx5pkql9guzzp9g00fxh2xk2j","tb1qrnlu25nn8h5rnv8dwys9ffkv0fcw7acrqpu09m","tb1qsenufe757js32mmrdq7mgzuzhsrl0ve6rld7gq","tb1q87xhsk5r3rkjgrdgqapv3yns5hhsu0zdj2n69n"]}',
			)
			.reply(
				200,
				'{"data":{"tb1qwzwugs68sv2f8svsuredhr8ddvnc8tksef5yz3":true,"tb1qtxjg2tzzza7lr60cxadpkp0cuv5zt07h0r2hxs":false,"tb1q0jeyzuj3fwz6nyughmmdsap47xl8zkxcgrta2j":false,"tb1qp4ekevzujt0mcgxvm5lhz2svaujq3qsjrv864d":false,"tb1qdzt03vpcnq4xtcgalgj8je75crmt98ahwd56h6":false,"tb1qgp5hrr4kvplfjg6rnr3her89duz6sgcjr9l6xg":false,"tb1qtcpgl08nh52wtqgndhr7wssa0aw5288nj83w58":false,"tb1q6utl7cpzt6dnm8sp5v8279yxmv2ufu9a4fhuy0":false,"tb1qu2nhuylpw9djpejejzjv8x43qfw7h72qq49hyz":false,"tb1qlnsmeq973nlpkn3dfrgzdtmxm7sxwwnkcmpcz3":false,"tb1qupf7xlutsld6ajpe33z7njlum87qnpx6ug9vj9":false,"tb1qh5gvyp77juyh6tw0y3pfkgpmfh885su7tsn2cr":false,"tb1quf58kja4u48xkgpqdzcsunyafx3w83prvalczq":false,"tb1qr5u0nj2v3p4fxdlnhy6j0xw8ajmlnaxgf5zwy9":false,"tb1qzz96d5w6q3rvjmharjxeft53826y00eyykjk43":false,"tb1q0rnzxz59djmhdh6ej6apk7gg4dvyv205ued4fl":false,"tb1qu2qmfvd559w7z57u0z6kpw2us4mg5fm0my3jdu":false,"tb1qe6zdvnvqgchsxwpg58nkqqdnzv2esn4wx4ekt3":false,"tb1qs84p0jy342cj8ylvxvrtjrpz9l64369uwpcy3p":false,"tb1qvy9mdyfprzauhva9kfsfl7pl8g6j8clp4w85w0":false,"tb1qqjfdux0x5dltzy5hnmgcrnazgq4xcfl7t70xyw":false,"tb1q6rl6ad84g7hww59dwmzsqxhmx5q989fx3378cs":false,"tb1qgpfcm8ug0a9j4lkc77pm29gukl30l9hta2tty2":false,"tb1qdkfqe29cyklwh9mlvsu93qqkj9tx9hrpj9vcpy":false,"tb1qu9swqvrfkmza5jzxze0e83yruenrqfkyz42vch":false,"tb1ql65ylgcypcrdraa4e8tjfwj2dlu5y4kxtjz057":false,"tb1qzykv02g9z9u3vzksjz0ta9xslnsskytpcxjar7":false,"tb1qxmkcgulllpd256ft6zm9pm56tltapw8nhyethm":false,"tb1qrwjvnttd9ddvjspkf77p7maan3snpf09unaugd":false,"tb1q7tarkqsfgteqx79r2t20uwtzl9vva0wx0k4ayz":false,"tb1qlgvxqyl6w35702k2u2939nn9yk59ke453gc8du":false,"tb1q88p4j7zgz9qkmmqn2hnpedtvyydadmf8f0nqce":false,"tb1qveme33aqk50pcgf8ha0x7yk7070zn24adr56vr":false,"tb1q8cvxlzztlx4kjmxw69k0l3mw7gpg7dwyen7t63":false,"tb1q8ecj0zt4wx9nwfvv7zzdd4a5hqft4vweqy5u98":false,"tb1qc4yzwmqf5dj60rkzrjwrl6y3p2hjxvmfz6335g":false,"tb1q03zk0hqnn6efw6jgjxzdh8ecapwe0zq3wn42cl":false,"tb1q5taend7m5cu7t320uwdeeqvxdg2qvj3knh9xqh":false,"tb1qfr6taz70f5nal6p8yu0w0p42tdhl8y5stc0wyh":false,"tb1qk0rfj3fmfaxym8jzzghw7xj0hvey2a6nqtsk25":false,"tb1qgfh9l7mexv9e46tztt9m73reke9u48q6uunmhu":false,"tb1qaa6u30n6t33x3qtkfqgr0csaudv67gn3lf8g6d":false,"tb1q5p2z4m2zcdx4d2lnh07y43qfkzssdz0aqy2wsp":false,"tb1qrj38tggucdz80pwn3qa8862laa8s68cyhc2l7k":false,"tb1q9vuv9rxdcuekrzc7cnwphltdd3jkfrrrcra7er":false,"tb1q3efwr9h42h67wqgqhr8vkhhn8jh75307ndk65z":false,"tb1q5fvq44fnq4u8p6jn83my26ryfy2urqppghavl8":false,"tb1q9tdrprakpaa988mfc8rcz8pz463h0m0nrf522w":false,"tb1qmuc75aqktsuqcx0euzmxx80kfskytt5tnukr52":false,"tb1q7tjr75nnk6jcja50mhclnvrerx24umv5wh0sy0":false,"tb1q0lynmvww482c655eykytt8cayvmmre4je5qwvv":false,"tb1qpvwctppnn7z42zgkcxuqwlvn3h5gqdwrpvxz3q":false,"tb1qexrzqvj2zwedpzvx9wygtvxwt60vf8v3pzshmr":false,"tb1qfyq8zvc5d2qg4kuaj73qgsp8fjr2rsmvlkvpme":false,"tb1qu57cwgs7qsxm8qup7rsxtj66fe5ga535ll2hfp":false,"tb1qee2tzzywvurq25rk40mts9ktepe54a3zftm2yx":false,"tb1qej8tsceu9md3zg0v65hwyeer2gc6jvyk0qtdnp":false,"tb1qk9fufzr5v4n4r5gwdtp0k936m68jttm6hcaxe7":false,"tb1qjqxv88rt5r6hu3x2ss6rwdstz7efyp5hufcpd4":false,"tb1q0rwmmpuyuzyfzglksxuahwqckxarqmhd0pvfp7":false,"tb1qzxkrjd7s600c4f3a2lltm9hkkxut77ewu4unsp":false,"tb1qg80u5d8uczmaumwu33deejppsqjujtax9r9dhc":false,"tb1q8cgvxnmgwhyp3ep2zpx2cxhufl9pk63qdxm26d":false,"tb1q3spthwkc28zdc23yn435vv2z8ewda694u4m9a0":false,"tb1qweawrnsqe5vxdmpjfwyqx9s9r37pwnvypygve5":false,"tb1q6w7866urtvha9t6kq65est66z9ufx2vuueqfpx":false,"tb1q00hfkswhpy70mrssqqqh0x22r7jsmzt33f56ep":false,"tb1q04unutzqzj7ly984pvkffc75f023l5vc4639yu":false,"tb1qgvpuuwjev6e6e8f7qrtsunnsc9ldnt24ewrwfd":false,"tb1qu2gssd6t5krj9lurjy6dnk0tnfwg22pajvw9my":false,"tb1q3s6gvwctm94h5j5jp7su5l4wxupw5qnvs4nwjv":false,"tb1q45mp7jusv8q0ksq0enfagt6z0kx0ef6gdzv5p9":false,"tb1qassvj4kccfwmevt3d6ee8j8zzwr2luynwpsp0a":false,"tb1qmhrc3xrj9z4zuhkvvhx45vulspgg0j4nl3ykm4":false,"tb1qhkrtsvlnntlwqfev5egcd02h54ualu2ss8zmjm":false,"tb1q3ws0px0ehkg6xueucf7dsqwz2cj2fszs2mpym9":false,"tb1qphn2683pdvpz5lgndl5ref486aehp30ghgeqw9":false,"tb1q69ct8fadgrx0gz8kpze3msnefew5k9r3xxa8yk":false,"tb1q70y6wq5twl2hjycehn8cgj3y2xgnq0qcem8elm":false,"tb1q2pugxd8avs5ewk3cfq6d6c25ug9yf7r3278s5x":false,"tb1q3n8a2mhsav2wuxm0myeatuemce8m7d2z3f37ta":false,"tb1qapqysswftgya80ec3svav4n9sjryc3uy07t5wk":false,"tb1qxv33cmhzgzkmpdtyduzxujtz3xy8m8f37g3mps":false,"tb1q7uamgk7mhrwhczfeuxasm0csyq5a8qyyng4ac4":false,"tb1qwlhdldau0778uw30cnfkhs4g5k0rnzdzvph6gt":false,"tb1qprxun35jdxfd9hfcps58atyx5rsl487wkxuw72":false,"tb1q9599m2gx9kmtxty4hg4np0dkn0nx8e4dts735w":false,"tb1qut5a3g6xzse2x8w6rw5uqj8ev5jj0cud8jlrew":false,"tb1qusmz2sygj7yn9jthvjaqm4n2l8kj783wgq6fdy":false,"tb1qntqz4443sya2cm3vevhc2hgxljtykt7f5kkl6x":false,"tb1qthptzxnvw7hvv9ph8vr5lgexwsdgq2zl7yr0pw":false,"tb1q9e9yz469vpyyexjf9lpyf5cnxsnvegptyk40rw":false,"tb1q2q0zgn9yf9pgfhxzu9hg9a3hcu6u77d9p8f2n0":false,"tb1q0yer2sty4rsjcat2qn722pt806h89fpa7q3r9x":false,"tb1q7q6ry5cm57e2qk549zpylpznlzuc03zya3luzv":false,"tb1q2uv9y43l4jyszf7y4mmgrpqn38ll6rkcapyvz9":false,"tb1qzya00lztregd6sx5pkql9guzzp9g00fxh2xk2j":false,"tb1qrnlu25nn8h5rnv8dwys9ffkv0fcw7acrqpu09m":false,"tb1qsenufe757js32mmrdq7mgzuzhsrl0ve6rld7gq":false,"tb1q87xhsk5r3rkjgrdgqapv3yns5hhsu0zdj2n69n":false}}',
				[],
			);

		nock.fake("https://btc-test.arkvault.io:443", { encodedQueryParams: true })
			.post(
				"/api/wallets/addresses",
				'{"addresses":["tb1qp2c7hrs54lzyhl9725tkyxrwhw4utfucagjk62","tb1q28sfszezu2m897hru9d74dh7ymuufq3qreqe74","tb1qggv0a06dyl0y5wtfp0ng4ldx3e7l05z7vhha9u","tb1q0clqkpstx6kqtc7pcjsq5gqsvvzru2hw23dgft","tb1qp37xzafn5raf0sy9wtk6x4gn65ryrzsuy392cq","tb1qhhptumtv9t2arzqpsjekwxcfr8yxsrmzaelqtm","tb1q5363t2jk5p52wul33vv5pqpdy8kzf34n8hjxqy","tb1qfcauqmu53wenn08lz8vn8r3d05m4pw0t2jva2a","tb1q2knjf7qw6q2evn3lffrrw48rpg5s0w08xs7mjh","tb1q0nahjdqxdghwtk9fwl8w58pe63dcf2ddqc2ujh","tb1qsfksc08negtpm3u5mdysxza9zavlr3psurj40y","tb1q0wumuaw6z536nmut807cag8ptef607asggdx7u","tb1qex89rll2enrvn739t5xdt0nw8sk4td4j2n20sv","tb1ql2yss43fejy2ex05d7www8mvqvp4t5p66ccm30","tb1qjct7ymngtq6qqrlps0q28gu8qfrpyuxc7f9quz","tb1q5j6htpxkwyxqdakjk4hwpc5h8ynty7sel5035v","tb1qkljlrleglask3ncx5djerqr8gygnnmgj36wf7h","tb1qu7pmw9jkzs290q60ltqqzpq55gfrytzsywnuf3","tb1qdzxs3weadduze3ul20rrpy5tqzqse3ht9s0llh","tb1qcuccs8rxevallss7hkaxkudhxfspwyfcv6sq6m","tb1q2zwpvk4pqmytk4rr0ylcg69xly77pmkxnsnlr5","tb1qwm7sjjuh048acz9pz3jqffxadqyymnlmz0yw8e","tb1q3x5888nyxeee7pn85vv74m837zh6ken48naqaa","tb1q40374m9wdv6q4zugg50mvtpa6j03qnlcrszypg","tb1q7pnj7nhh5jrj2nq2hx5qxxeq5hprqe53pg9k2k","tb1ql9ulx4zagx5p9xzd2epjm34m9x4jezn4ueq669","tb1q3pnh9qyaej8rn6zqtgghlxlzmfj0453dspgxzd","tb1qvh0a2gru9j82judjh6rfnsgy4ws0m2293agney","tb1q0nfp7q77nfre8uvvn0ket06w9yaydvpz68p9lr","tb1q04dwnzx83sme2rfln6w4vpmggwjjchjxr8zkx9","tb1qf0tdj68uyzqly3w5en9drqwnz6sa4n6lsk476s","tb1qk8qr5y642jgkhculch3e6pc6v0xge0arnldxmt","tb1qdv5xh4j4njfjuqeqdj2dmhvswvehelayx4m7ym","tb1qpu9scl04pk4j7q7u9vdfz8un2673eh0qy4l0eg","tb1qpsjyh7t7csr8rj2cysyacprtlewp970zerkeza","tb1qqfuy3340a9adthlsw8vhqn60ywcts9pshaetfv","tb1q6kjamng3eguc9xrnslvj3akt22h7lmmjq852vy","tb1qlkdemrc9xu4afg3p8x0zk4c9s7l2d7v726wsrr","tb1qrvus8qlt99zk4yfkd3uvxec4ply8fg0vrdrl3e","tb1qsr5ffrwzgfagrwjyq2pv2srnsefv2edmsvgqwm","tb1qltxv5ms98khhhd2yrkuyeus4sqa5dn8227rgkq","tb1qwacalyc95ap53kuljed28cvwu2sejs7h266k7k","tb1qnv4qmkgpfhyadf9j6wr652nwe99h3seqwmqx7y","tb1qnn7vpp59njhgc38c6utfjzqrnlchcl039yfnhn","tb1qulwap6w2dymnnamfn4tn628l30m6dz40md2kxt","tb1qxns6lceznfjyez4t0e68xl3h6n4dxe57k6h0qa","tb1qejk3882duegrcgl4wzyk4w536ht0fctpmv5rn4","tb1qsthnlj3wfsrvj72pe8w6fsqu4e8nksp05s06sw","tb1qrrwgq7vuawyyk2hj6s9waezj80utrfqugays6g","tb1q97uyjqdm7za7pcyhtu2873vdhemt5u0jl9vd7d","tb1q4hflrpz7c3zradl5ehewhk8smh68jjtpufkhc9","tb1qrsr6k3sn9zwujrlg3pfzp07mwz80qjtrx2yw6z","tb1q08al65sd77pjump4nxycag4w3n4fp63d2smvj3","tb1q62fmnhzpywj7gt8d8amaztc3d9u7ny9m3g7ze8","tb1qgcn3ltjacdmc6ugayt74axl8xg4pz666pw8973","tb1q9fhq04hsxscntfeywv798d9ay3qvw5c7shfn2y","tb1q4f3w2glv82ap822mn8g6tx8qslyjvuaupkj5p6","tb1qr57sat8g3vu7d7hkjwha50mg2522zj3hjv05c7","tb1qt54vrrq4jrzrvusuuyzx329w99ztg3zfnhqy63","tb1quhuunfwlhupdjp5vw63jsvk4psygwnz2np0235","tb1q98r4pg35khfhw6nvxkqaumx0ezrfrv28ph5xp0","tb1qr8uh996cqrnfdp0j08xa7x4qldzsry8dhu635u","tb1qrp70zs9x4tddk0l7f467vnuqccmyx4km4utu39","tb1q7ucja4pzvuez46rvevnh5zgxt8h0qtjxad9swu","tb1q4vwrap2av85d9e0tf6vtwqsjanzwhy744mdt0u","tb1q5hf2zrlkm3vs5eexyfn9jcqsycv2lgd5ecj237","tb1qd8dnwxdjjmryz7drlwsey46a5mf340ve7jakp0","tb1qd363u698c4dtzs9wphhn84gqlmcyvjjmdr3zl7","tb1qfnaz6hx6qd2w8kkd9mwjzvpa8ya966rv2dzds4","tb1qdu4y3y577vrgq7xvfchwf7rg0fsq87d7w6jc8f","tb1qvywnawemyf78upvh4p56jdgjf4ewddw8vkesfr","tb1qg0hxdgnruk8fmhg7ctvej74jaxgk0hzapepudd","tb1q0h54rdfvq23genyqte6xwl9pne3pruxv0jd894","tb1qh6pvzkc3lk3x773vkxzqc0rkehycag6cmjeywc","tb1qte8hcc5q3m4qh2geme4tpny4g5ssy0fgfae7vf","tb1q5wedn3xguswt94ngyf69crmh6pjuakpvrp0qwa","tb1qvpm4llr2q9fle7arfu8ls42gavetlaqr2t90gk","tb1qwxw2jvchghchet2dtl5wghu5d8vdy3wezmlsn3","tb1qzx6eewvzd3jhjfxtaxpfc807tr07t84422e4f5","tb1qajtw95xgunhee6zr5myh6qg3crumqqeaaz4kpg","tb1q85an5gplk74s36yza520qy976s9z3hfvpzacg3","tb1q3l87mp38fa3kr366cu8vsf3v8kaw02fjllwj88","tb1qnsdlh8cynxsxmtdm60xxpj2x5qr7c5t3uwd89c","tb1qehxuturxvgtuhv7329uypwhv2ev3n84kt9655c","tb1qlvvxyxz6k3z2m3qy4vzd92ee4yndp2ffe42mum","tb1ql3h3rg6xauzgkpzneapea9rnqmjfqu2zqnqfw2","tb1qwnrhwykwh6zyck5jc7386m397avzxl353zatve","tb1qcjwqv45ayq9970m3kdflrrxluz9v7m6pr42lqv","tb1qs0nwlqyujxc8lu8dhf4fjyv9mumh7v3rumahka","tb1qyweetgycv0v66pts8wcxkjtvmtwge25cdz4mnt","tb1qkefsdsne6meea9v5a97zwd6pnrc6kr647r7erq","tb1qkgts0vdu9k0ss0hn4urvuanpwkmga8qkf3qztv","tb1qts0ukwg925eetc3dpvk8d526twwrgmgaakmg6a","tb1q627xyatdlpv0f83lzg9u9uz73uqdjr32renk2f","tb1qnn6t0j4cumgt8qpxs9dcgf9d99mmmqnz9yl6qj","tb1q5cdppu6zk2zxqshctk4pcgfkf4dy5w263advwd","tb1qqxq4tkvzuhzzuvp728whh2pjhmh67c2x5svq90","tb1qgn609emj4qs752307pfdardl8h7vywpvl9yufn","tb1q4t353yrl8k4sgwq2ws9837z7d03txdn726fjys","tb1qdjl28xqrkr7uhzu3kmknnl8jqvaewrf875vtk5"]}',
			)
			.reply(
				200,
				'{"data":{"tb1qp2c7hrs54lzyhl9725tkyxrwhw4utfucagjk62":true,"tb1q28sfszezu2m897hru9d74dh7ymuufq3qreqe74":false,"tb1qggv0a06dyl0y5wtfp0ng4ldx3e7l05z7vhha9u":false,"tb1q0clqkpstx6kqtc7pcjsq5gqsvvzru2hw23dgft":false,"tb1qp37xzafn5raf0sy9wtk6x4gn65ryrzsuy392cq":false,"tb1qhhptumtv9t2arzqpsjekwxcfr8yxsrmzaelqtm":false,"tb1q5363t2jk5p52wul33vv5pqpdy8kzf34n8hjxqy":false,"tb1qfcauqmu53wenn08lz8vn8r3d05m4pw0t2jva2a":false,"tb1q2knjf7qw6q2evn3lffrrw48rpg5s0w08xs7mjh":false,"tb1q0nahjdqxdghwtk9fwl8w58pe63dcf2ddqc2ujh":false,"tb1qsfksc08negtpm3u5mdysxza9zavlr3psurj40y":false,"tb1q0wumuaw6z536nmut807cag8ptef607asggdx7u":false,"tb1qex89rll2enrvn739t5xdt0nw8sk4td4j2n20sv":false,"tb1ql2yss43fejy2ex05d7www8mvqvp4t5p66ccm30":false,"tb1qjct7ymngtq6qqrlps0q28gu8qfrpyuxc7f9quz":false,"tb1q5j6htpxkwyxqdakjk4hwpc5h8ynty7sel5035v":false,"tb1qkljlrleglask3ncx5djerqr8gygnnmgj36wf7h":false,"tb1qu7pmw9jkzs290q60ltqqzpq55gfrytzsywnuf3":false,"tb1qdzxs3weadduze3ul20rrpy5tqzqse3ht9s0llh":false,"tb1qcuccs8rxevallss7hkaxkudhxfspwyfcv6sq6m":false,"tb1q2zwpvk4pqmytk4rr0ylcg69xly77pmkxnsnlr5":false,"tb1qwm7sjjuh048acz9pz3jqffxadqyymnlmz0yw8e":false,"tb1q3x5888nyxeee7pn85vv74m837zh6ken48naqaa":false,"tb1q40374m9wdv6q4zugg50mvtpa6j03qnlcrszypg":false,"tb1q7pnj7nhh5jrj2nq2hx5qxxeq5hprqe53pg9k2k":false,"tb1ql9ulx4zagx5p9xzd2epjm34m9x4jezn4ueq669":false,"tb1q3pnh9qyaej8rn6zqtgghlxlzmfj0453dspgxzd":false,"tb1qvh0a2gru9j82judjh6rfnsgy4ws0m2293agney":false,"tb1q0nfp7q77nfre8uvvn0ket06w9yaydvpz68p9lr":false,"tb1q04dwnzx83sme2rfln6w4vpmggwjjchjxr8zkx9":false,"tb1qf0tdj68uyzqly3w5en9drqwnz6sa4n6lsk476s":false,"tb1qk8qr5y642jgkhculch3e6pc6v0xge0arnldxmt":false,"tb1qdv5xh4j4njfjuqeqdj2dmhvswvehelayx4m7ym":false,"tb1qpu9scl04pk4j7q7u9vdfz8un2673eh0qy4l0eg":false,"tb1qpsjyh7t7csr8rj2cysyacprtlewp970zerkeza":false,"tb1qqfuy3340a9adthlsw8vhqn60ywcts9pshaetfv":false,"tb1q6kjamng3eguc9xrnslvj3akt22h7lmmjq852vy":false,"tb1qlkdemrc9xu4afg3p8x0zk4c9s7l2d7v726wsrr":false,"tb1qrvus8qlt99zk4yfkd3uvxec4ply8fg0vrdrl3e":false,"tb1qsr5ffrwzgfagrwjyq2pv2srnsefv2edmsvgqwm":false,"tb1qltxv5ms98khhhd2yrkuyeus4sqa5dn8227rgkq":false,"tb1qwacalyc95ap53kuljed28cvwu2sejs7h266k7k":false,"tb1qnv4qmkgpfhyadf9j6wr652nwe99h3seqwmqx7y":false,"tb1qnn7vpp59njhgc38c6utfjzqrnlchcl039yfnhn":false,"tb1qulwap6w2dymnnamfn4tn628l30m6dz40md2kxt":false,"tb1qxns6lceznfjyez4t0e68xl3h6n4dxe57k6h0qa":false,"tb1qejk3882duegrcgl4wzyk4w536ht0fctpmv5rn4":false,"tb1qsthnlj3wfsrvj72pe8w6fsqu4e8nksp05s06sw":false,"tb1qrrwgq7vuawyyk2hj6s9waezj80utrfqugays6g":false,"tb1q97uyjqdm7za7pcyhtu2873vdhemt5u0jl9vd7d":false,"tb1q4hflrpz7c3zradl5ehewhk8smh68jjtpufkhc9":false,"tb1qrsr6k3sn9zwujrlg3pfzp07mwz80qjtrx2yw6z":false,"tb1q08al65sd77pjump4nxycag4w3n4fp63d2smvj3":false,"tb1q62fmnhzpywj7gt8d8amaztc3d9u7ny9m3g7ze8":false,"tb1qgcn3ltjacdmc6ugayt74axl8xg4pz666pw8973":false,"tb1q9fhq04hsxscntfeywv798d9ay3qvw5c7shfn2y":false,"tb1q4f3w2glv82ap822mn8g6tx8qslyjvuaupkj5p6":false,"tb1qr57sat8g3vu7d7hkjwha50mg2522zj3hjv05c7":false,"tb1qt54vrrq4jrzrvusuuyzx329w99ztg3zfnhqy63":false,"tb1quhuunfwlhupdjp5vw63jsvk4psygwnz2np0235":false,"tb1q98r4pg35khfhw6nvxkqaumx0ezrfrv28ph5xp0":false,"tb1qr8uh996cqrnfdp0j08xa7x4qldzsry8dhu635u":false,"tb1qrp70zs9x4tddk0l7f467vnuqccmyx4km4utu39":false,"tb1q7ucja4pzvuez46rvevnh5zgxt8h0qtjxad9swu":false,"tb1q4vwrap2av85d9e0tf6vtwqsjanzwhy744mdt0u":false,"tb1q5hf2zrlkm3vs5eexyfn9jcqsycv2lgd5ecj237":false,"tb1qd8dnwxdjjmryz7drlwsey46a5mf340ve7jakp0":false,"tb1qd363u698c4dtzs9wphhn84gqlmcyvjjmdr3zl7":false,"tb1qfnaz6hx6qd2w8kkd9mwjzvpa8ya966rv2dzds4":false,"tb1qdu4y3y577vrgq7xvfchwf7rg0fsq87d7w6jc8f":false,"tb1qvywnawemyf78upvh4p56jdgjf4ewddw8vkesfr":false,"tb1qg0hxdgnruk8fmhg7ctvej74jaxgk0hzapepudd":false,"tb1q0h54rdfvq23genyqte6xwl9pne3pruxv0jd894":false,"tb1qh6pvzkc3lk3x773vkxzqc0rkehycag6cmjeywc":false,"tb1qte8hcc5q3m4qh2geme4tpny4g5ssy0fgfae7vf":false,"tb1q5wedn3xguswt94ngyf69crmh6pjuakpvrp0qwa":false,"tb1qvpm4llr2q9fle7arfu8ls42gavetlaqr2t90gk":false,"tb1qwxw2jvchghchet2dtl5wghu5d8vdy3wezmlsn3":false,"tb1qzx6eewvzd3jhjfxtaxpfc807tr07t84422e4f5":false,"tb1qajtw95xgunhee6zr5myh6qg3crumqqeaaz4kpg":false,"tb1q85an5gplk74s36yza520qy976s9z3hfvpzacg3":false,"tb1q3l87mp38fa3kr366cu8vsf3v8kaw02fjllwj88":false,"tb1qnsdlh8cynxsxmtdm60xxpj2x5qr7c5t3uwd89c":false,"tb1qehxuturxvgtuhv7329uypwhv2ev3n84kt9655c":false,"tb1qlvvxyxz6k3z2m3qy4vzd92ee4yndp2ffe42mum":false,"tb1ql3h3rg6xauzgkpzneapea9rnqmjfqu2zqnqfw2":false,"tb1qwnrhwykwh6zyck5jc7386m397avzxl353zatve":false,"tb1qcjwqv45ayq9970m3kdflrrxluz9v7m6pr42lqv":false,"tb1qs0nwlqyujxc8lu8dhf4fjyv9mumh7v3rumahka":false,"tb1qyweetgycv0v66pts8wcxkjtvmtwge25cdz4mnt":false,"tb1qkefsdsne6meea9v5a97zwd6pnrc6kr647r7erq":false,"tb1qkgts0vdu9k0ss0hn4urvuanpwkmga8qkf3qztv":false,"tb1qts0ukwg925eetc3dpvk8d526twwrgmgaakmg6a":false,"tb1q627xyatdlpv0f83lzg9u9uz73uqdjr32renk2f":false,"tb1qnn6t0j4cumgt8qpxs9dcgf9d99mmmqnz9yl6qj":false,"tb1q5cdppu6zk2zxqshctk4pcgfkf4dy5w263advwd":false,"tb1qqxq4tkvzuhzzuvp728whh2pjhmh67c2x5svq90":false,"tb1qgn609emj4qs752307pfdardl8h7vywpvl9yufn":false,"tb1q4t353yrl8k4sgwq2ws9837z7d03txdn726fjys":false,"tb1qdjl28xqrkr7uhzu3kmknnl8jqvaewrf875vtk5":false}}',
				[],
			);

		nock.fake("https://btc-test.arkvault.io:443", { encodedQueryParams: true })
			.post(
				"/api/wallets",
				'{"addresses":["tb1qwzwugs68sv2f8svsuredhr8ddvnc8tksef5yz3","tb1qp2c7hrs54lzyhl9725tkyxrwhw4utfucagjk62"]}',
			)
			.reply(
				200,
				'{"data":{"balance":69854,"address":["tb1qwzwugs68sv2f8svsuredhr8ddvnc8tksef5yz3","tb1qp2c7hrs54lzyhl9725tkyxrwhw4utfucagjk62"],"publicKey":"figure this out"}}',
				[],
			);

		const xpub =
			"tpubDDTDFecT5cBGojUhJwZeWYduhUrSL11ncLpMQM4ciRT2f3BnY1HZF2Di8GPLJdUSP7KMtS3kLL3bG7FowHBF1T9QTTBk9K2pqqdk1cbTEnB";

		const result = await context.subject.wallet({ method: "bip84", type: "extendedPublicKey", value: xpub });

		assert.instance(result, WalletData);
		assert.equal(result.address(), [
			"tb1qwzwugs68sv2f8svsuredhr8ddvnc8tksef5yz3",
			"tb1qp2c7hrs54lzyhl9725tkyxrwhw4utfucagjk62",
		]);
		assert.is(result.publicKey(), "figure this out");
		assert.is(result.balance().available.toNumber(), 69_854);
	});

	it("broadcast should pass", async (context) => {
		nock.fake("https://btc-test.arkvault.io")
			.post("/api/transactions")
			.reply(200, loader.json(`test/fixtures/client/broadcast.json`));

		const result = await context.subject.broadcast([
			createService(SignedTransactionData).configure("id", "transactionPayload", ""),
		]);

		assert.equal(result, {
			accepted: ["id"],
			errors: {},
			rejected: [],
		});
	});

	it("broadcast should fail", async (context) => {
		nock.fake("https://btc-test.arkvault.io")
			.post("/api/transactions")
			.reply(200, loader.json(`test/fixtures/client/broadcast-failure.json`));

		const result = await context.subject.broadcast([
			createService(SignedTransactionData).configure("id", "transactionPayload", ""),
		]);

		assert.equal(result, {
			accepted: [],
			errors: {
				id: "bad-txns-in-belowout, value in (0.00041265) < value out (1.00) (code 16)",
			},
			rejected: ["id"],
		});
	});
});
